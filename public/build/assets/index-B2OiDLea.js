import{Q as ee,d as v,p as J,o as r,e as a,a as e,j as y,l as K,v as h,f as u,g as H,t as d,F as C,h as B,n as se,b as R,u as P,z as S,D as re,k as ae,c as le,w as ne}from"./app-Cugkdl7Z.js";import{S as D,_ as ie}from"./AppLayout-Blclsjs2.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{c as ue}from"./createLucideIcon-Cfx3_lQN.js";/**
 * @license lucide-vue-next v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=ue("XIcon",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ce={class:"min-h-screen pt-10 no-print"},pe={class:"max-w-5xl mx-auto bg-white rounded-lg p-1"},ve={class:"mb-6 border-b pb-4"},ge={class:"flex gap-5 justify-between items-center flex-col md:flex-row"},fe={class:"flex gap-4 items-center no-print"},xe={key:0,class:"flex flex-col gap-2 items-center"},me={class:"flex flex-col md:flex-row gap-3 items-center"},be={class:"flex gap-5"},ye={class:"grid grid-cols-2 gap-4"},he={class:"capitalize"},_e={class:"border-b border-gray-200 overflow-scroll"},we={class:"-mb-px flex space-x-8"},ke=["onClick"],$e={class:"mt-6 overflow-scroll"},Ce={class:"min-w-full divide-y divide-gray-200"},Se={key:0,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},Ee={key:1,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},Te={key:2,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},Ve={key:3,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},Ie={key:4,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},Ue={key:5,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},Ne={class:"bg-white divide-y divide-gray-200"},Be={key:0},ze={class:"px-6 py-4 whitespace-nowrap"},je={key:0,class:"flex gap-2"},Ae=["onUpdate:modelValue"],De=["onClick"],Ge={class:"ml-5 text-sm text-gray-500"},Me={key:0,class:"px-6 py-4"},Fe={key:1,class:"px-6 py-4"},Le=["onUpdate:modelValue","onInput"],Pe={key:1},He={key:2,class:"px-6 py-4 font-medium"},Re={key:3,class:"px-6 py-4"},Oe={key:4,class:"px-6 py-4"},qe={key:5,class:"px-6 py-4"},Qe=["onUpdate:modelValue"],Xe={key:0,class:"mt-6 flex justify-end"},We=["disabled"],Je={key:1,class:"mt-6 flex justify-end no-print"},Ke=["disabled"],Ye=["disabled"],Ze={id:"print-all",class:"print-all-tabs"},et={class:"mb-8"},tt={class:"text-xl font-bold mb-4 capitalize"},ot={class:"min-w-full divide-y divide-gray-200"},st={key:0,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},rt={key:1,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},at={key:2,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},lt={key:3,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},nt={key:4,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},it={key:5,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},dt={class:"px-6 py-4 whitespace-nowrap"},ut={key:0,class:"flex gap-2"},ct={class:"w-48"},pt={class:"ml-5 text-sm text-gray-500"},vt={key:0,class:"px-6 py-4"},gt={key:1,class:"px-6 py-4"},ft=["onUpdate:modelValue","onInput"],xt={key:1},mt={key:2,class:"px-6 py-4 font-medium"},bt={key:3,class:"px-6 py-4"},yt={key:4,class:"px-6 py-4"},ht={key:5,class:"px-6 py-4"},_t={class:"w-fit rounded-md border-gray-300 shadow-sm text-center"},wt={__name:"RegistroInventario",setup(Y){const{props:f}=ee(),z=(s,o)=>{D.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,customClass:"no-print",didOpen:t=>{t.addEventListener("mouseenter",D.stopTimer),t.addEventListener("mouseleave",D.resumeTimer)}}).fire({icon:s,title:o})},w=v(null),I=v(null),G=v(null),E=v("day"),j=v(f.inventario),T=v(f.registros),_=v(f.gastos||[]),O=v(f.categorias),n=v("bebida"),b=v(!1),q=v(f.user.roles[0]==="almacen"),g=v(!1),Q=()=>{w.value=null,I.value=null,G.value=null,g.value=!1,S.get("/inventario",{},{preserveScroll:!0})},p=()=>{let s=E.value,o=null;if(s==="day"?o=w.value:s==="week"?o=I.value:s==="month"&&(o=G.value),!o){z("error","Debes seleccionar una fecha");return}S.post("/inventario/filtro",{filter:s,value:o},{preserveScroll:!0,onSuccess(t){console.log("Respuesta completa del servidor:",t.props),T.value=t.props.registros,j.value=t.props.inventario,_.value=t.props.gastos;const U=new Map(t.props.registros.map(m=>[m.inventario_id,m]));k.value=j.value.filter(m=>m.nombre!=="-").map(m=>{const L=U.get(m.id)||{};return{...m,existe:L.existe||0,entra:L.entra||0,total:L.total||0,vende:L.vende||0,sobra:L.sobra||0,costo:L.precio||(m==null?void 0:m.costo)||0}}),g.value=!0,z("success","Filtro actualizado correctamente")},onError(t){console.error("Error al obtener datos:",t),z("error",t.props.flash.error||"Error al obtener datos con este filtro"),error.value="Ocurrió un error al obtener los datos. Inténtalo de nuevo.",isLoading.value=!1}})},N=J(()=>{var s,o;return console.log("Filtrando productos con activeTab:",n.value),n.value==="gastos"?_.value:n.value==="pastes"||n.value==="sobrantes"?(s=k==null?void 0:k.value)==null?void 0:s.filter(t=>t.tipo==="pastes"||t.tipo==="empanadas saladas"||t.tipo==="empanadas dulces"):(o=k==null?void 0:k.value)==null?void 0:o.filter(t=>t.tipo===n.value)});async function M(){try{b.value=!0;const s={sobrantes:k.value.filter(o=>o.existe>0).map(o=>({inventario_id:o.id,sucursal_id:f.sucursal_id,nombre:o.nombre,cantidad:o.existe}))};S.post("/sobrantes",s,{preserveScroll:!0,preserveState:!0,onSuccess:()=>{Toast.fire({icon:"success",title:"Sobrantes guardados exitosamente"})},onError:o=>{console.error("Error al guardar sobrantes:",o),Toast.fire({icon:"error",title:"Error al guardar los sobrantes"})}})}catch(s){console.error("Error al guardar sobrantes:",s),Toast.fire({icon:"error",title:"Error al guardar los sobrantes"})}finally{b.value=!1}}function X(){_.value.push({nombre:"",costo:0})}function x(s){_.value.splice(s,1)}const W=[...O.value.filter(s=>s.tipo!=="empanadas saladas"&&s.tipo!=="empanadas dulces").map(s=>s.tipo==="masa"?{name:"Tortillas y Bolas",id:s.tipo}:s.tipo==="pastes"?{name:"Pastes / Empanadas",id:s.tipo}:{id:s.tipo,name:s.tipo}),...q.value?[]:[{id:"gastos",name:"Gastos generales"},{id:"sobrantes",name:"Sobrantes"}]],k=v(j.value.filter(s=>s.nombre!=="-").map(s=>{var o,t;return{...s,existe:((o=T.value[s.id-1])==null?void 0:o.existe)||(s==null?void 0:s.existe)||0,entra:0,total:null,sobra:(t=T.value[s.id-1])==null?void 0:t.existe,costo:(s==null?void 0:s.costo)||0}})),F=J(()=>n.value==="bebida"||n.value==="extras"||n.value==="pastes"),$=s=>{const o=f.ventas.find(t=>t.producto_id===s);return o?o.total_vendido:0},A=s=>g.value?s.total:i(s)+($(s)||0)+s.entra,c=s=>g.value?s.sobra:A(s)-$(s.id),l=s=>{s.total=(s.existe||0)+(s.entra||0);const o=$(s.id);s.sobra=s.total-o};function i(s){const o=$(s.id);return g.value?s.existe+Number(o):s.cantidad+Number(o)}async function V(){try{b.value=!0;const s={gastos:_.value.map(o=>({id:o.id||null,sucursal_id:o.sucursal_id||0,nombre:o.nombre,costo:o.costo||0}))};S.post("/gastos",s,{preserveScroll:!0,preserveState:!1,onSuccess:o=>{Toast.fire({icon:"success",title:"Gastos guardados exitosamente"}),n.value="gastos",_.value=o.props.gastos},onError:o=>{console.error("Error al guardar:",o),Toast.fire({icon:"error",title:"Error al guardar los gastos"})}})}catch(s){console.error("Error al guardar:",s),Toast.fire({icon:"error",title:"Error al guardar los gastos"})}finally{b.value=!1}}async function te(){try{b.value=!0;const s={productos:k.value.map(o=>({id:o.id,existe:o.existe||0,entra:o.entra||0,total:A(o),vende:Number($(o.id)),costo:o.costo||0,sobra:c(o)}))};S.post("/registro",{registros:s},{preserveScroll:!0,preserveState:!1,replace:!0,onSuccess:()=>{console.log("Registro guardado exitosamente")},onError:o=>{console.error("Error al guardar:",o)}}),Toast.fire({icon:"success",title:"Registro guardado exitosamente"})}catch(s){console.error("Error al guardar:",s),Toast.fire({icon:"error",title:"Error al guardar el registro"})}finally{b.value=!1}}const oe=()=>{window.print()};return(s,o)=>(r(),a(C,null,[e("div",ce,[e("div",pe,[e("div",ve,[e("div",ge,[o[8]||(o[8]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Registro de Inventario",-1)),e("div",fe,[s.$page.props.user.roles[0]!="trabajador"?(r(),a("div",xe,[e("div",me,[o[6]||(o[6]=e("label",{for:"fecha"},"Buscar por:",-1)),e("div",be,[y(e("select",{class:"rounded",id:"filter","onUpdate:modelValue":o[0]||(o[0]=t=>E.value=t)},o[5]||(o[5]=[e("option",{value:"day"},"Día",-1),e("option",{value:"week"},"Semana",-1),e("option",{value:"month"},"Mes",-1)]),512),[[K,E.value]]),E.value==="day"?y((r(),a("input",{key:0,class:"w-fit h-fit rounded",id:"valueSelect",type:"date","onUpdate:modelValue":o[1]||(o[1]=t=>w.value=t)},null,512)),[[h,w.value]]):u("",!0),E.value==="week"?y((r(),a("input",{key:1,class:"w-fit h-fit rounded",id:"valueSelect",type:"week","onUpdate:modelValue":o[2]||(o[2]=t=>I.value=t)},null,512)),[[h,I.value]]):u("",!0),E.value==="month"?y((r(),a("input",{key:2,class:"w-fit h-fit rounded",id:"valueSelect",type:"month","onUpdate:modelValue":o[3]||(o[3]=t=>G.value=t)},null,512)),[[h,G.value]]):u("",!0)])]),e("div",ye,[e("button",{onClick:p,class:"no-print bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",type:"button"},"Buscar"),e("button",{onClick:Q,class:"no-print bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded",type:"button"},"Limpiar filtro"),e("button",{onClick:oe,class:"bg-green-500 text-white px-4 py-2 rounded no-print"},[o[7]||(o[7]=H(" Imprimir inventario - ")),e("span",he,d(n.value),1)])])])):u("",!0)])])]),e("div",_e,[e("nav",we,[(r(),a(C,null,B(W,t=>e("button",{key:t.id,onClick:U=>n.value=t.id,class:se(["whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm capitalize",n.value===t.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},d(t.name),11,ke)),64))])]),e("div",$e,[e("table",Ce,[e("thead",null,[e("tr",null,[o[9]||(o[9]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Nombre",-1)),n.value==="gastos"?(r(),a("th",Se," Costo ")):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("th",Ee," Existe ")):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("th",Te," Entra ")):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("th",Ve," Total ")):u("",!0),F.value?(r(),a("th",Ie," Vendidos ")):u("",!0),n.value!=="gastos"?(r(),a("th",Ue," Sobra ")):u("",!0)])]),e("tbody",Ne,[n.value==="gastos"?(r(),a("tr",Be,[e("td",{colspan:"2",class:"px-6 py-4"},[e("div",{class:""},[e("button",{onClick:X,class:"text-blue-600 hover:text-blue-800"}," + Agregar nuevo gasto ")])])])):u("",!0),(r(!0),a(C,null,B(N.value,(t,U)=>(r(),a("tr",{key:U},[e("td",ze,[n.value==="gastos"?(r(),a("div",je,[y(e("input",{type:"text","onUpdate:modelValue":m=>t.nombre=m,class:"w-48 rounded-md border-gray-300 shadow-sm",placeholder:"Nombre del gasto"},null,8,Ae),[[h,t.nombre]]),e("button",{onClick:m=>x(U),class:"text-red-600 no-print hover:text-red-800"},[R(P(Z),{class:"no-print"})],8,De)])):(r(),a(C,{key:1},[e("h1",null,d(t.nombre),1),e("span",Ge,d(t.detalle),1)],64))]),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("td",Me,d(g.value?t.total-t.entra:i(t)),1)):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("td",Fe,[g.value?(r(),a("div",Pe,d(g.value?t.entra:0),1)):y((r(),a("input",{key:0,"onUpdate:modelValue":m=>t.entra=m,type:"number",min:"0",placeholder:"0",class:"w-20 rounded-md border-gray-300 shadow-sm text-center",onInput:m=>l(t)},null,40,Le)),[[h,t.entra,void 0,{number:!0}]])])):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("td",He,d(g.value?t.total:A(t)),1)):u("",!0),F.value&&n.value!=="sobrantes"?(r(),a("td",Re,d(g.value?t.vende:$(t.id)),1)):u("",!0),n.value!=="gastos"?(r(),a("td",Oe,d(g.value?t.sobra:c(t)),1)):u("",!0),n.value==="gastos"&&n.value!=="sobrantes"?(r(),a("td",qe,[y(e("input",{"onUpdate:modelValue":m=>t.costo=m,type:"number",min:"0",placeholder:"0",class:"w-fit rounded-md border-gray-300 shadow-sm text-center"},null,8,Qe),[[h,t.costo,void 0,{number:!0}]])])):u("",!0)]))),128))])])]),n.value==="sobrantes"?(r(),a("div",Xe,[e("button",{onClick:M,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",disabled:b.value},d(b.value?"Guardando...":"Guardar Sobrantes"),9,We)])):(r(),a("div",Je,[n.value==="gastos"?(r(),a("button",{key:0,onClick:V,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",disabled:b.value},d(b.value?"Guardando...":"Guardar Gastos"),9,Ke)):(r(),a("button",{key:1,onClick:te,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",disabled:b.value},d(b.value?"Guardando...":"Guardar Registro"),9,Ye))]))])]),e("div",Ze,[e("div",et,[e("h2",tt,d(n.value),1),e("table",ot,[e("thead",null,[e("tr",null,[o[10]||(o[10]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Nombre",-1)),n.value==="gastos"?(r(),a("th",st," Costo ")):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("th",rt," Existe ")):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("th",at," Entra ")):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("th",lt," Total ")):u("",!0),F.value?(r(),a("th",nt," Vendidos ")):u("",!0),n.value!=="gastos"?(r(),a("th",it," Sobra ")):u("",!0)])]),e("tbody",null,[(r(!0),a(C,null,B(N.value,t=>(r(),a("tr",{key:t.index},[e("td",dt,[n.value==="gastos"?(r(),a("div",ut,[e("span",ct,d(t.nombre),1),e("button",{onClick:o[4]||(o[4]=U=>x(s.index)),class:"text-red-600 hover:text-red-800"},[R(P(Z),{class:"no-print"})])])):(r(),a(C,{key:1},[e("h1",null,d(t.nombre),1),e("span",pt,d(t.detalle),1)],64))]),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("td",vt,d(g.value?t.total-t.entra:i(t)),1)):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("td",gt,[g.value?(r(),a("div",xt,d(g.value?t.entra:0),1)):y((r(),a("input",{key:0,"onUpdate:modelValue":U=>t.entra=U,type:"number",min:"0",placeholder:"0",class:"w-20 rounded-md border-gray-300 shadow-sm text-center",onInput:U=>l(t)},null,40,ft)),[[h,t.entra,void 0,{number:!0}]])])):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("td",mt,d(g.value?t.total:A(t)),1)):u("",!0),F.value&&n.value!=="sobrantes"?(r(),a("td",bt,d(g.value?t.vende:$(t.id)),1)):u("",!0),n.value!=="gastos"?(r(),a("td",yt,d(g.value?t.sobra:c(t)),1)):u("",!0),n.value==="gastos"&&n.value!=="sobrantes"?(r(),a("td",ht,[e("span",_t,d(t.costo),1)])):u("",!0)]))),128))])])])])],64))}},kt=de(wt,[["__scopeId","data-v-03ddb09b"]]),$t={class:"container mx-auto p-8 md:p-10"},Ct={class:"space-y-4 mb-5 no-print"},St={class:"flex justify-between items-center"},Et={class:"flex items-center space-x-2"},Tt={class:"text-lg font-semibold text-gray-800"},Vt={class:"text-gray-600 text-sm"},It={class:"text-gray-600 text-sm"},Ut={class:"font-medium text-gray-800 capitalize"},Nt={class:"text-sm text-gray-700"},Bt={class:"mt-2 space-y-1"},zt={class:"text-sm text-gray-700 space-y-1 pl-4 list-disc"},jt={key:0,class:"text-xs"},At={class:"flex justify-end"},Dt=["onClick"],Gt={key:0,class:"no-print flex flex-col md:flex-row gap-10 w-full"},Mt={class:"md:w-4/12 w-full"},Ft={class:"bg-white shadow rounded-lg p-6 mb-6"},Lt={class:"text-xl font-semibold mb-4"},Pt=["value"],Ht={class:"flex justify-end space-x-2"},Rt={type:"submit",class:"px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500"},Ot={key:0,class:"w-full"},qt={class:"md:w-8/12 w-full"},Qt={class:"mb-4"},Xt={class:"bg-white shadow rounded-lg overflow-auto h-screen"},Wt={class:"min-w-full divide-y divide-gray-200"},Jt={class:"bg-white divide-y divide-gray-200"},Kt={class:"py-1 px-2 whitespace bg-gray-50"},Yt={class:"py-1 px-2 whitespace-nowrap"},Zt={class:"py-1 px-2 whitespace bg-gray-50"},eo={class:"py-1 px-2 whitespace-nowrap"},to={class:"py-1 px-2 whitespace-nowrap bg-gray-50"},oo={class:"py-1 px-2 whitespace-nowrap text-sm font-medium flex flex-col gap-1 place-items-center"},so=["onClick"],ro=["onClick"],ao={key:1,class:"no-print fixed inset-0 bg-gray-900 bg-opacity-50 flex justify-center items-center z-50"},lo={class:"bg-white p-6 rounded-lg shadow-lg w-96"},no={key:2,class:"fixed inset-0 bg-gray-900 bg-opacity-50 flex justify-center items-center z-50"},io={class:"bg-white p-6 rounded-lg shadow-lg w-96"},uo=["value"],co={__name:"Inventario",setup(Y){var A;const{props:f}=ee(),z=v(f.tickets),w=v((A=f==null?void 0:f.inventario)==null?void 0:A.filter(c=>c.nombre!="-")),I=v(f.categorias),G=v(f.user.roles[0]==="almacen"),E=v(!1),j=v(!1),T=v(),_=v(""),O=()=>{E.value=!0},n=()=>{j.value=!0},b=()=>{E.value=!1,j.value=!1,_.value=""},q=()=>{_.value.trim()?(S.post("/categorias",{tipo:_.value},{preserveScroll:!0,preserveState:!1,replace:!0,onSuccess:c=>{x.fire({icon:"success",title:"Categoría agregada correctamente"}),I.value=c.props.categorias},onError:c=>{x.fire({icon:"error",title:"Hubo un problema al agregar la categoría"})}}),b()):x.fire({icon:"error",title:"Por favor, ingresa un nombre para la categoría"})},g=c=>{S.put(`/tickets/${c}`,{estado:"completado"},{preserveScroll:!0,preserveState:!1,replace:!0,onSuccess:l=>{x.fire({icon:"success",title:"Ticket completado correctamente"}),z.value=l.props.tickets},onError:l=>{x.fire({icon:"error",title:"Hubo un problema al completar el ticket"}),console.error(l)}})},Q=()=>{var c;(c=T==null?void 0:T.value)!=null&&c.tipo.trim()?(S.delete(`/categorias/${T.value.tipo}`,{preserveScroll:!0,preserveState:!1,replace:!0,onSuccess:l=>{l.props.flash.success?(x.fire({icon:"success",title:"Categoría eliminada correctamente"}),I.value=l.props.categorias):x.fire({icon:"error",title:"La categoría tiene mas de un elemento aún en alguna sucursal"})},onError:l=>{x.fire({icon:"error",title:"Hubo un problema al eliminar la categoría"})}}),b()):x.fire({icon:"error",title:"Por favor, selecciona una categoría"})},p=re({id:null,nombre:"",detalle:"",tipo:"",cantidad:0,precio:0}),N=v(!1),M=v(""),X=J(()=>{var c;return(c=w==null?void 0:w.value)==null?void 0:c.filter(l=>l.nombre.toLowerCase().includes(M.value.toLowerCase())||l.tipo.toLowerCase().includes(M.value.toLowerCase()))}),x=D.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1500,timerProgressBar:!0,didOpen:c=>{c.onmouseenter=D.stopTimer,c.onmouseleave=D.resumeTimer}}),W=()=>{N.value?S.put(`/inventario/${p.id}`,{nombre:p.nombre,detalle:p.detalle,tipo:p.tipo,cantidad:p.cantidad,precio:p.precio},{preserveScroll:!0,preserveState:!1,replace:!0,onSuccess:c=>{x.fire({icon:"success",title:"Actualizado correctamente"}),w.value=c.props.inventario,$()},onError:c=>{x.fire({icon:"error",title:"Hubo un problema al actualizar el ítem"})}}):S.post("/inventario",{nombre:p.nombre,detalle:p.detalle,tipo:p.tipo,cantidad:p.cantidad,precio:p.precio},{preserveScroll:!0,preserveState:!1,replace:!0,onSuccess:c=>{x.fire({icon:"success",title:"Agregado correctamente"}),w.value=c.props.inventario,$()},onError:c=>{x.fire({icon:"error",title:"Hubo un problema al agregar el ítem"})}})},k=c=>{Object.assign(p,c),N.value=!0},F=c=>{D.fire({title:"¿Estás seguro?",text:"¡No podrás revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#e66f23",cancelButtonColor:"#3085d6",confirmButtonText:"Sí, eliminarlo",cancelButtonText:"Cancelar"}).then(l=>{l.isConfirmed&&S.delete(`/inventario/${c}`,{preserveScroll:!0,preserveState:!1,replace:!0,onSuccess:i=>{x.fire({icon:"success",title:"Eliminado correctamente"}),w.value=i.props.inventario},onError:i=>{x.fire({icon:"error",title:"Hubo un problema al eliminar el ítem"})}})})},$=()=>{Object.assign(p,{id:null,nombre:"",detalle:"",tipo:"",cantidad:0,precio:0}),N.value=!1};return(c,l)=>(r(),a("div",$t,[l[20]||(l[20]=e("h1",{class:"text-2xl font-bold mb-4"},"Gestión de Inventario",-1)),e("div",Ct,[(r(!0),a(C,null,B(z.value,i=>(r(),a("div",{key:i.id,class:"flex flex-col gap-4 p-4 border rounded-lg shadow-sm bg-white"},[e("div",St,[e("div",Et,[e("span",Tt,"Ticket #"+d(i.id),1),e("span",Vt,"Fecha: "+d(i.created_at.split("T")[0]),1)]),e("div",It,[l[9]||(l[9]=H(" Estado: ")),e("span",Ut,d(i.estado),1)])]),e("div",null,[e("div",Nt,[l[10]||(l[10]=e("span",{class:"font-medium"},"Hora de salida:",-1)),H(" "+d(i.hora_salida||"N/A"),1)]),e("div",Bt,[l[11]||(l[11]=e("h4",{class:"text-sm font-medium text-gray-800"},"Productos asignados:",-1)),e("ul",zt,[(r(!0),a(C,null,B(i.ticket_productos_asignacion,V=>(r(),a("li",{class:"flex gap-1 items-center",key:V.id},[H(d(V.cantidad)+"x "+d(V.producto.nombre),1),V.producto.detalle?(r(),a("p",jt,"- "+d(V.producto.detalle),1)):u("",!0)]))),128))])])]),e("div",At,[e("button",{onClick:V=>g(i.id),class:"bg-orange-500 text-white px-4 py-2 rounded-md hover:bg-orange-600 focus:outline-none focus:ring focus:ring-orange-200 focus:ring-opacity-50"}," Completar ",8,Dt)])]))),128))]),P(f).user.roles[0]==="admin"||P(f).user.roles[0]==="sucursal"||P(f).user.roles[0]==="almacen"?(r(),a("div",Gt,[e("div",Mt,[e("div",Ft,[e("h2",Lt,d(N.value?"Editar Item":"Agregar Nuevo Item"),1),e("form",{onSubmit:ae(W,["prevent"]),class:"space-y-4"},[e("div",null,[l[12]||(l[12]=e("label",{for:"itemName",class:"block text-sm font-medium text-gray-700"},"Nombre del Item",-1)),y(e("input",{"onUpdate:modelValue":l[0]||(l[0]=i=>p.nombre=i),id:"itemName",type:"text",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50"},null,512),[[h,p.nombre]])]),e("div",null,[l[13]||(l[13]=e("label",{for:"itemCategory",class:"block text-sm font-medium text-gray-700"},"Categoría",-1)),y(e("select",{"onUpdate:modelValue":l[1]||(l[1]=i=>p.tipo=i),id:"itemCategory",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50"},[(r(!0),a(C,null,B(I.value,i=>(r(),a("option",{key:i.id,class:"capitalize",value:i.tipo},d(i.tipo),9,Pt))),128))],512),[[K,p.tipo]])]),e("div",null,[l[14]||(l[14]=e("label",{for:"itemDetalle",class:"block text-sm font-medium text-gray-700"},"Detalle del item",-1)),y(e("input",{"onUpdate:modelValue":l[2]||(l[2]=i=>p.detalle=i),id:"itemDetalle",type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50"},null,512),[[h,p.detalle]])]),e("div",null,[l[15]||(l[15]=e("label",{for:"itemQuantity",class:"block text-sm font-medium text-gray-700"},"Cantidad",-1)),y(e("input",{"onUpdate:modelValue":l[3]||(l[3]=i=>p.cantidad=i),id:"itemQuantity",type:"number",required:"",min:"0",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50"},null,512),[[h,p.cantidad,void 0,{number:!0}]])]),e("div",null,[l[16]||(l[16]=e("label",{for:"itemPrice",class:"block text-sm font-medium text-gray-700"},"Precio Unitario",-1)),y(e("input",{"onUpdate:modelValue":l[4]||(l[4]=i=>p.precio=i),id:"itemPrice",type:"number",required:"",min:"0",step:"0.01",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50"},null,512),[[h,p.precio,void 0,{number:!0}]])]),e("div",Ht,[e("button",{type:"button",onClick:$,class:"px-4 py-2 border border-transparent text-sm font-medium rounded-md text-gray-700 bg-gray-200 hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500"}," Cancelar "),e("button",Rt,d(N.value?"Actualizar":"Agregar"),1)])],32)]),G.value?(r(),a("div",Ot,[e("button",{onClick:O,class:"bg-orange-500 w-full hover:bg-orange-700 text-white font-bold py-2 px-4 rounded mb-4"}," Agregar nueva categoría "),e("button",{onClick:n,class:"bg-red-500 w-full hover:bg-red-700 text-white font-bold py-2 px-4 rounded mb-4"}," Eliminar categoría ")])):u("",!0)]),e("div",qt,[e("div",Qt,[y(e("input",{"onUpdate:modelValue":l[5]||(l[5]=i=>M.value=i),type:"text",placeholder:"Buscar en el inventario...",class:"w-full px-4 py-2 rounded-md border-gray-300 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50",onInput:l[6]||(l[6]=(...i)=>c.searchInventory&&c.searchInventory(...i))},null,544),[[h,M.value]])]),e("div",Xt,[e("table",Wt,[l[17]||(l[17]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Categoría"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Detalle"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Existentes"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Precio"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Acciones")])],-1)),e("tbody",Jt,[(r(!0),a(C,null,B(X.value,i=>(r(),a("tr",{key:i.id,class:"text-center"},[e("td",Kt,d(i.nombre),1),e("td",Yt,d(i.tipo),1),e("td",Zt,d(i.detalle),1),e("td",eo,d(i.cantidad),1),e("td",to,"$"+d(i.precio),1),e("td",oo,[e("button",{onClick:V=>k(i),class:"bg-orange-600 py-1 px-2 text-white rounded-lg hover:bg-orange-900 mr-2"},"Editar",8,so),e("button",{onClick:V=>F(i.id),class:"bg-red-600 py-1 px-2 text-white rounded-lg hover:bg-red-900"},"Eliminar",8,ro)])]))),128))])])])])])):u("",!0),R(kt),E.value?(r(),a("div",ao,[e("div",lo,[l[18]||(l[18]=e("h2",{class:"text-xl font-semibold mb-4"},"Agregar Categoría",-1)),y(e("input",{"onUpdate:modelValue":l[7]||(l[7]=i=>_.value=i),type:"text",placeholder:"Nombre de la categoría",class:"w-full mb-4 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"},null,512),[[h,_.value]]),e("div",{class:"flex justify-end space-x-2"},[e("button",{onClick:b,class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg"}," Cancelar "),e("button",{onClick:q,class:"px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg"}," Agregar ")])])])):u("",!0),j.value?(r(),a("div",no,[e("div",io,[l[19]||(l[19]=e("h2",{class:"text-xl font-semibold mb-4"},"Eliminar Categoría",-1)),y(e("select",{"onUpdate:modelValue":l[8]||(l[8]=i=>T.value=i),class:"w-full mb-4 px-3 py-2 border rounded-lg capitalize focus:outline-none focus:ring-2 focus:ring-orange-500"},[(r(!0),a(C,null,B(I.value,i=>(r(),a("option",{key:i.id,value:i,class:"capitalize"},d(i.tipo),9,uo))),128))],512),[[K,T.value]]),e("div",{class:"flex justify-end space-x-2"},[e("button",{onClick:b,class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg"}," Cancelar "),e("button",{onClick:Q,class:"px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg"}," Eliminar ")])])])):u("",!0)]))}},po={class:"py-6 px-2"},vo={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},go={class:"bg-white overflow-hidden shadow-xl rounded-lg py-2"},yo={__name:"index",setup(Y){return(f,z)=>(r(),le(ie,{title:"Tablero principal"},{default:ne(()=>[e("div",po,[e("div",vo,[e("div",go,[R(co)])])])]),_:1}))}};export{yo as default};
