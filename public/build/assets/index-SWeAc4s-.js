import{S as Q,_ as X}from"./AppLayout-B-RLNewv.js";import{Q as O,d as c,i as U,o as l,e as n,a as e,j as g,v as I,k as f,F as y,h as _,t as o,l as q,n as E,f as w,m as J,u as K,c as R,w as W,b as Y}from"./app-Bg7eYEyM.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={class:"relative px-6 py-8 bg-white shadow-lg sm:rounded-3xl sm:p-12"},ee={class:"mb-6 bg-gray-50 p-4 rounded-lg"},te={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},se=["value"],oe=["value"],ae={class:"mt-4 flex justify-end"},le=["disabled"],ne={key:0},re={key:1},ie={class:"mb-6 grid grid-cols-2 md:grid-cols-4 gap-4"},de={class:"bg-blue-50 p-4 rounded-lg border border-blue-200"},ue={class:"text-2xl font-bold text-blue-800"},ce={class:"bg-yellow-50 p-4 rounded-lg border border-yellow-200"},pe={class:"text-2xl font-bold text-yellow-800"},ge={class:"text-sm text-yellow-600"},xe={class:"bg-green-50 p-4 rounded-lg border border-green-200"},be={class:"text-2xl font-bold text-green-800"},me={class:"text-sm text-green-600"},ve={class:"bg-purple-50 p-4 rounded-lg border border-purple-200"},fe={class:"text-2xl font-bold text-purple-800"},ye={class:"overflow-x-auto"},_e={class:"min-w-full bg-white border border-gray-200 rounded-lg"},he={class:"px-4 py-3 border-b"},we={class:"text-sm font-medium text-gray-900"},ke={class:"text-xs text-gray-500"},Se={class:"px-4 py-3 border-b text-sm text-gray-700"},Fe={class:"px-4 py-3 border-b text-sm text-gray-700"},$e={class:"px-4 py-3 border-b"},Ce={class:"px-4 py-3 border-b"},Ve={class:"px-4 py-3 border-b text-sm text-gray-700"},Pe=["title"],Te={key:1},je={key:0},Ae={key:0,class:"mt-4 flex justify-center items-center space-x-2"},Me=["disabled"],Ne={class:"text-sm text-gray-600"},Be=["disabled"],De={class:"mt-2 text-center text-sm text-gray-500"},h=20,Ue={__name:"ActividadPersonal",setup(z){const{props:d}=O(),k=c(d.usuarios||[]),S=c(d.sucursales||[]),p=c(d.actividades||[]),u=c(d.resumen||{}),r=c({fecha_inicio:d.fechaInicio||new Date().toISOString().split("T")[0],fecha_fin:d.fechaFin||new Date().toISOString().split("T")[0],sucursal_id:null,usuario_id:null,tipo_actividad:null}),x=c(!1),i=c(1),b=U(()=>Math.ceil(p.value.length/h)),F=U(()=>{const a=(i.value-1)*h,t=a+h;return p.value.slice(a,t)}),G=async()=>{x.value=!0,i.value=1;try{const a=await J.post("/actividad-personal/filtro",r.value);p.value=a.data.actividades,u.value=a.data.resumen}catch(a){console.error("Error al filtrar:",a),Q.fire({icon:"error",title:"Error",text:"No se pudieron cargar las actividades",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}finally{x.value=!1}},$=a=>new Intl.NumberFormat("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2}).format(a),H=a=>({produccion:"bg-orange-100 text-orange-800",venta:"bg-green-100 text-green-800",asistencia:"bg-purple-100 text-purple-800",inventario:"bg-blue-100 text-blue-800",gasto:"bg-red-100 text-red-800",corte_caja:"bg-gray-100 text-gray-800"})[a]||"bg-gray-100 text-gray-800",L=(a,t)=>a==="venta"?t==="manual"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800":a==="asistencia"?t==="entrada"?"bg-green-100 text-green-800":"bg-red-100 text-red-800":a==="produccion"&&{pendiente:"bg-yellow-100 text-yellow-800",horneando:"bg-orange-100 text-orange-800",en_espera:"bg-blue-100 text-blue-800",vendido:"bg-green-100 text-green-800"}[t]||"bg-gray-100 text-gray-800";return(a,t)=>{var v,C,V,P,T,j,A,M,N;return l(),n("div",Z,[t[21]||(t[21]=e("h1",{class:"text-3xl font-semibold mb-6 text-center"},"Actividad del Personal",-1)),e("div",ee,[e("div",te,[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha Inicio",-1)),g(e("input",{type:"date","onUpdate:modelValue":t[0]||(t[0]=s=>r.value.fecha_inicio=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},null,512),[[I,r.value.fecha_inicio]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha Fin",-1)),g(e("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=s=>r.value.fecha_fin=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},null,512),[[I,r.value.fecha_fin]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Sucursal",-1)),g(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>r.value.sucursal_id=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},[t[9]||(t[9]=e("option",{value:null},"Todas las sucursales",-1)),(l(!0),n(y,null,_(S.value,s=>(l(),n("option",{key:s.id,value:s.id},o(s.nombre),9,se))),128))],512),[[f,r.value.sucursal_id]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Usuario",-1)),g(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>r.value.usuario_id=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},[t[11]||(t[11]=e("option",{value:null},"Todos los usuarios",-1)),(l(!0),n(y,null,_(k.value,s=>(l(),n("option",{key:s.id,value:s.id},o(s.nombre_completo),9,oe))),128))],512),[[f,r.value.usuario_id]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tipo",-1)),g(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>r.value.tipo_actividad=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},t[13]||(t[13]=[q('<option>Todos los tipos</option><option value="produccion">Produccion</option><option value="venta">Ventas</option><option value="asistencia">Asistencia</option><option value="inventario">Inventario</option><option value="gasto">Gastos</option><option value="corte_caja">Corte de Caja</option>',7)]),512),[[f,r.value.tipo_actividad]])])]),e("div",ae,[e("button",{onClick:G,disabled:x.value,class:"bg-orange-500 text-white px-6 py-2 rounded-md hover:bg-orange-600 transition-colors duration-200 disabled:opacity-50"},[x.value?(l(),n("span",ne,"Cargando...")):(l(),n("span",re,"Filtrar"))],8,le)])]),e("div",ie,[e("div",de,[t[15]||(t[15]=e("div",{class:"text-sm text-blue-600 font-medium"},"Total Actividades",-1)),e("div",ue,o(u.value.total_actividades),1)]),e("div",ce,[t[16]||(t[16]=e("div",{class:"text-sm text-yellow-600 font-medium"},"Ventas Manuales",-1)),e("div",pe,o(((C=(v=u.value.ventas)==null?void 0:v.manuales)==null?void 0:C.cantidad)||0),1),e("div",ge,"$"+o($(((P=(V=u.value.ventas)==null?void 0:V.manuales)==null?void 0:P.total)||0)),1)]),e("div",xe,[t[17]||(t[17]=e("div",{class:"text-sm text-green-600 font-medium"},"Ventas Sistema (POS)",-1)),e("div",be,o(((j=(T=u.value.ventas)==null?void 0:T.sistema)==null?void 0:j.cantidad)||0),1),e("div",me,"$"+o($(((M=(A=u.value.ventas)==null?void 0:A.sistema)==null?void 0:M.total)||0)),1)]),e("div",ve,[t[18]||(t[18]=e("div",{class:"text-sm text-purple-600 font-medium"},"Asistencias",-1)),e("div",fe,o(((N=u.value.por_tipo)==null?void 0:N.asistencia)||0),1)])]),e("div",ye,[e("table",_e,[t[20]||(t[20]=e("thead",{class:"bg-gray-100"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Fecha/Hora"),e("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Usuario"),e("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Sucursal"),e("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Tipo"),e("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Subtipo"),e("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Detalles")])],-1)),e("tbody",null,[(l(!0),n(y,null,_(F.value,s=>{var B,D;return l(),n("tr",{key:s.id,class:"hover:bg-gray-50 transition-colors"},[e("td",he,[e("div",we,o(s.fecha),1),e("div",ke,o(s.hora),1)]),e("td",Se,o(s.usuario),1),e("td",Fe,o(s.sucursal),1),e("td",$e,[e("span",{class:E([H(s.tipo),"px-2 py-1 text-xs font-medium rounded-full"])},o(s.tipo_label),3)]),e("td",Ce,[e("span",{class:E([L(s.tipo,s.subtipo),"px-2 py-1 text-xs font-medium rounded-full"])},o(s.subtipo_label),3)]),e("td",Ve,[s.tipo==="venta"&&((D=(B=s.extra)==null?void 0:B.productos)!=null&&D.length)?(l(),n("span",{key:0,title:s.extra.productos.map(m=>`${m.nombre} x${m.cantidad} = $${(m.cantidad*m.precio_unitario).toFixed(2)}`).join(`
`),class:"cursor-help underline decoration-dotted"},o(s.detalles),9,Pe)):(l(),n("span",Te,o(s.detalles),1))])])}),128)),p.value.length===0?(l(),n("tr",je,t[19]||(t[19]=[e("td",{colspan:"6",class:"px-4 py-8 text-center text-gray-500"}," No se encontraron actividades para los filtros seleccionados ",-1)]))):w("",!0)])])]),b.value>1?(l(),n("div",Ae,[e("button",{onClick:t[5]||(t[5]=s=>i.value=Math.max(1,i.value-1)),disabled:i.value===1,class:"px-3 py-1 border rounded-md disabled:opacity-50 hover:bg-gray-100"}," Anterior ",8,Me),e("span",Ne," Pagina "+o(i.value)+" de "+o(b.value),1),e("button",{onClick:t[6]||(t[6]=s=>i.value=Math.min(b.value,i.value+1)),disabled:i.value===b.value,class:"px-3 py-1 border rounded-md disabled:opacity-50 hover:bg-gray-100"}," Siguiente ",8,Be)])):w("",!0),e("div",De," Mostrando "+o(F.value.length)+" de "+o(p.value.length)+" actividades ",1)])}}},Ie={class:"py-6"},Ee={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 p-2 md:p-8"},Oe={class:"bg-white overflow-hidden shadow-xl rounded-xl"},Le={__name:"index",setup(z){const{props:d}=O();return(k,S)=>K(d).user.roles[0]!=="trabajador"?(l(),R(X,{key:0,title:"Actividad Personal"},{default:W(()=>[e("div",Ie,[e("div",Ee,[e("div",Oe,[Y(Ue)])])])]),_:1})):w("",!0)}};export{Le as default};
