import{S as w,_ as J}from"./AppLayout-jyhPu7_Z.js";import{o as l,e as o,a as t,b as j,n as E,u as U,t as u,F as h,h as g,f as r,Q as F,d as f,p as b,c as V,k as K,j as v,v as m,l as D,q as W,z,w as X}from"./app-DUrf9sYs.js";import{c as Y}from"./createLucideIcon-BOXkUQvC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/**
 * @license lucide-vue-next v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=Y("CircleAlertIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),ee={key:0,class:"card grid gap-2"},se={class:"flex items-center gap-2"},te={class:"font-bold text-xl"},le={class:"table-auto w-full border"},I={__name:"CardContratos",props:{contratos:Array,title:String,color:String},setup(x){const c=_=>_?new Date(_).toLocaleDateString():"N/A";return(_,y)=>x.contratos.length>0?(l(),o("div",ee,[t("span",se,[j(U(Z),{size:32,class:E(["animate-pulse",x.color==="red"?"text-red-500":"text-yellow-500"])},null,8,["class"]),t("h2",te,u(x.title),1)]),t("table",le,[y[0]||(y[0]=t("thead",{class:"bg-gray-200"},[t("tr",{class:"text-left"},[t("th",null,"Nombre"),t("th",null,"Apellido Paterno"),t("th",null,"Apellido Materno"),t("th",null,"Inicio del Contrato"),t("th",null,"Fin del Contrato")])],-1)),t("tbody",null,[(l(!0),o(h,null,g(x.contratos,n=>(l(),o("tr",{key:n.id},[t("td",null,u(n.name),1),t("td",null,u(n.apellido_p),1),t("td",null,u(n.apellido_m),1),t("td",null,u(c(n.inicio_contrato)),1),t("td",null,u(c(n.fin_contrato)),1)]))),128))])])])):r("",!0)}},oe={key:0,class:"relative px-10 py-10 bg-white shadow-lg sm:rounded-3xl sm:p-20"},re={key:0,class:"container my-10 grid gap-2"},ae={class:"mb-6 flex justify-center"},ne=["onClick"],ue={class:"flex justify-end mb-4"},ie={class:"mb-8 overflow-auto"},de={class:"text-xl font-semibold mb-4"},ce={class:"min-w-full bg-white border border-gray-200"},pe={key:0,class:"px-4 py-2 border-b"},ve={key:1,class:"px-4 py-2 border-b"},me={key:2,class:"px-4 py-2 border-b"},_e={key:3,class:"px-4 py-2 border-b"},be={key:4,class:"px-4 py-2 border-b"},xe={key:5,class:"px-4 py-2 border-b"},ye={key:6,class:"px-4 py-2 border-b"},fe={key:7,class:"px-4 py-2 border-b"},he={key:8,class:"px-4 py-2 border-b"},ge={key:9,class:"px-4 py-2 border-b"},ke={key:10,class:"px-4 py-2 border-b"},we={key:11,class:"px-4 py-2 border-b"},Ce={key:12,class:"px-4 py-2 border-b"},Se={key:0,class:"px-4 py-2 border-b"},Ve={key:1,class:"px-4 py-2 border-b"},Ue={key:2,class:"px-4 py-2 border-b"},Ae={key:3,class:"px-4 py-2 border-b"},Me={key:4,class:"px-4 py-2 border-b"},$e={key:5,class:"px-4 py-2 border-b"},Te={key:6,class:"px-4 py-2 border-b"},Ne={key:7,class:"px-4 py-2 border-b"},Be={key:8,class:"px-4 py-2 border-b"},De={key:0,class:"bg-green-500 text-white px-2 py-1 rounded-full"},ze={key:1,class:"bg-red-500 text-white px-2 py-1 rounded-full"},Ie={key:9,class:"px-4 py-2 border-b"},je={key:10,class:"px-4 py-2 border-b"},Ee={key:11,class:"px-4 py-2 border-b"},Fe={key:12,class:"px-4 py-2 border-b"},Pe={class:"px-4 py-2 border-b"},Le=["onClick"],He=["onClick"],Re={key:0,class:"fixed inset-0 bg-black w-full bg-opacity-50 flex items-center justify-center"},qe={class:"bg-white p-6 rounded-lg md:w-1/2 w-full m-5"},Oe={class:"text-xl font-semibold mb-4"},Ge={key:0},Qe={key:0,class:"text-red-500 text-sm"},Je={key:1,class:"text-red-500 text-sm"},Ke={key:2,class:"text-red-500 text-sm"},We={key:3,class:"text-red-500 text-sm"},Xe={class:"flex w-full space-x-4 mt-2"},Ye={class:"w-full"},Ze={key:0,class:"text-red-500 text-sm"},es={class:"w-full"},ss={key:0,class:"text-red-500 text-sm"},ts={key:4,class:"text-red-500 text-sm"},ls={key:5,class:"text-red-500 text-sm"},os=["value"],rs={key:6,class:"text-red-500 text-sm"},as=["value"],ns={class:"flex items-center mt-2"},us={key:7,class:"text-red-500 text-sm"},is={key:1,class:"flex flex-col"},ds={key:0,class:"text-red-500 text-sm"},cs={key:1,class:"text-red-500 text-sm"},ps={key:2,class:"text-red-500 text-sm"},vs={key:3,class:"text-red-500 text-sm"},ms={key:4,class:"text-red-500 text-sm"},_s={class:"flex justify-end"},bs={type:"submit",class:"bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600 transition-colors duration-200 ease-in-out"},xs={__name:"Personal",setup(x){const{props:c}=F();f(c.sucursales);const _=f(!1),y=b(()=>{var a,s;return(s=(a=c.auth)==null?void 0:a.user)!=null&&s.es_almacen?[{label:"Usuarios",value:"users"}]:[{label:"Usuarios",value:"users"},{label:"Sucursales",value:"sucursales"}]}),n=f("users"),i=f({id:null,id_user:null,name:"",apellido_p:"",apellido_m:"",inicio_contrato:"",fin_contrato:"",email:"",password:"",sucursal_id:"",role:"",nombre:"",direccion:"",telefono:"",active:!1}),P=b(()=>n.value==="users"?"Usuarios":"Sucursales"),A=b(()=>n.value==="users"?"Usuario":"Sucursal"),d=f({}),L=b(()=>n.value==="users"?c.users:c.sucursales.filter(a=>a.id!==0)),H=b(()=>{var s,e;const a=(e=(s=c.auth)==null?void 0:s.user)!=null&&e.es_almacen?["admin","trabajador"]:["admin","trabajador","supervisor"];return c.roles.filter(p=>a.includes(p.name))}),R=b(()=>{var a,s;return(s=(a=c.auth)==null?void 0:a.user)!=null&&s.es_almacen?c.sucursales.filter(e=>e.id===0):c.sucursales}),C=b(()=>{const a=new Date;return c.users.filter(s=>{if(s.fin_contrato===null)return!1;const e=new Date(s.fin_contrato);return isNaN(e)?!1:e<a})}),S=b(()=>{const a=new Date,s=5*24*60*60*1e3;return c.users.filter(e=>{if(e.fin_contrato===null||e.active===0)return!1;const p=new Date(e.fin_contrato);if(isNaN(p))return!1;const B=p-a;return B>0&&B<=s})}),M=a=>{if(!c.sucursales||!c.sucursalSession)return null;const s=c.sucursales.find(e=>e.id===a);if(s){const e=c.sucursalSession.find(p=>p.sucursal_id===s.id);if(e)return e}return null},$=()=>{var a,s;(s=(a=c.auth)==null?void 0:a.user)!=null&&s.es_almacen&&n.value==="users"&&(i.value.sucursal_id=0),_.value=!0},T=()=>{_.value=!1,N()},q=()=>{const a=!!i.value.id,s=a?`/${n.value}/${i.value.id}`:`/${n.value}`;z[a?"put":"post"](s,i.value,{preserveScroll:!0,onSuccess:p=>{k.fire({icon:"success",title:a?"Actualizado correctamente":"Agregado correctamente"}),n.value==="users"?c.users=p.props.users:(c.sucursales=p.props.sucursales,c.sucursalSession=p.props.sucursalSession),T()},onError:p=>{k.fire({icon:"error",title:"Hubo un problema al procesar la solicitud"}),d.value=p}})},O=a=>{n.value=a,N()},k=w.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1500,timerProgressBar:!0,didOpen:a=>{a.onmouseenter=w.stopTimer,a.onmouseleave=w.resumeTimer}}),G=a=>{var s,e,p;i.value={id:a.id,id_user:((s=M(a.id))==null?void 0:s.id)||null,name:a.name||"",apellido_p:a.apellido_p||"",apellido_m:a.apellido_m||"",tel:a.tel||"",email:a.email||((e=M(a.id))==null?void 0:e.email)||"",sucursal_id:a.sucursal_id||"",role:((p=a.roles)==null?void 0:p[0])||"",nombre:a.nombre||"",direccion:a.direccion||"",telefono:a.telefono||"",inicio_contrato:a.inicio_contrato||"",fin_contrato:a.fin_contrato||"",active:a.active||!1,password:""},$()},Q=a=>{w.fire({title:"¿Estás seguro?",text:"¡No podrás revertir esta acción!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Sí, eliminarlo",cancelButtonText:"Cancelar"}).then(s=>{s.isConfirmed&&z.delete(`/${n.value}/${a}`,{preserveScroll:!0,onSuccess:e=>{k.fire({icon:"success",title:"Eliminado correctamente"}),n.value==="users"?c.users=e.props.users:(c.sucursales=e.props.sucursales,c.sucursalSession=e.props.sucursalSession),d.value={}},onError:e=>{k.fire({icon:"error",title:d.value=e.error||"Hubo un problema al eliminar el elemento"}),d.value=e}})})},N=()=>{i.value={id:null,id_user:null,name:"",email:"",password:"",sucursal_id:"",role:"",nombre:"",direccion:"",telefono:""},d.value={}};return(a,s)=>U(c).user.roles[0]!=="supervisor"?(l(),o("div",oe,[s[25]||(s[25]=t("h1",{class:"text-3xl font-semibold mb-6 text-center"},"Gestión de Personal",-1)),t("div",null,[C.value.length>0||S.value.length>0?(l(),o("div",re,[S.value.length>0?(l(),V(I,{key:0,contratos:S.value,title:"Contratos por Vencer",color:"yellow"},null,8,["contratos"])):r("",!0),C.value.length>0?(l(),V(I,{key:1,contratos:C.value,title:"Contratos Vencidos",color:"red"},null,8,["contratos"])):r("",!0)])):r("",!0)]),t("div",ae,[(l(!0),o(h,null,g(y.value,e=>(l(),o("button",{key:e.value,onClick:p=>O(e.value),class:E(["px-4 py-2 mx-1 rounded-full transition-colors duration-200 ease-in-out",n.value===e.value?"bg-orange-500 text-white":"bg-gray-200 hover:bg-gray-300"])},u(e.label),11,ne))),128))]),t("div",ue,[t("button",{onClick:$,class:"bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600 transition-colors duration-200 ease-in-out"}," Agregar "+u(A.value),1)]),t("div",ie,[t("h2",de,u(P.value),1),t("table",ce,[t("thead",null,[t("tr",null,[n.value==="users"?(l(),o("th",pe,"Nombre")):r("",!0),n.value==="users"?(l(),o("th",ve,"Apellido P.")):r("",!0),n.value==="users"?(l(),o("th",me,"Apellido M.")):r("",!0),n.value==="users"?(l(),o("th",_e,"Telefono")):r("",!0),n.value==="users"?(l(),o("th",be,"Usuario")):r("",!0),n.value==="users"?(l(),o("th",xe,"Inicio Contrato")):r("",!0),n.value==="users"?(l(),o("th",ye,"Fin Contrato")):r("",!0),n.value==="users"?(l(),o("th",fe,"Sucursal")):r("",!0),n.value==="users"?(l(),o("th",he,"Activo")):r("",!0),n.value==="users"?(l(),o("th",ge,"Rol")):r("",!0),n.value==="sucursales"?(l(),o("th",ke,"Nombre de Sucursal")):r("",!0),n.value==="sucursales"?(l(),o("th",we,"Dirección")):r("",!0),n.value==="sucursales"?(l(),o("th",Ce,"Teléfono")):r("",!0),s[16]||(s[16]=t("th",{class:"px-4 py-2 border-b"},"Acciones",-1))])]),t("tbody",null,[(l(!0),o(h,null,g(L.value,e=>(l(),o("tr",{key:e.id,class:"hover:bg-gray-50"},[n.value==="users"?(l(),o("td",Se,u(e.name),1)):r("",!0),n.value==="users"?(l(),o("td",Ve,u(e.apellido_p),1)):r("",!0),n.value==="users"?(l(),o("td",Ue,u(e.apellido_m),1)):r("",!0),n.value==="users"?(l(),o("td",Ae,u(e.tel),1)):r("",!0),n.value==="users"?(l(),o("td",Me,u(e.email),1)):r("",!0),n.value==="users"?(l(),o("td",$e,u(e.inicio_contrato),1)):r("",!0),n.value==="users"?(l(),o("td",Te,u(e.fin_contrato),1)):r("",!0),n.value==="users"?(l(),o("td",Ne,u(e.sucursal),1)):r("",!0),n.value==="users"?(l(),o("td",Be,[e.active?(l(),o("span",De,"Activo")):(l(),o("span",ze,"Inactivo"))])):r("",!0),n.value==="users"?(l(),o("td",Ie,u(e.roles[0]||"Sin rol"),1)):r("",!0),n.value==="sucursales"?(l(),o("td",je,u(e.nombre),1)):r("",!0),n.value==="sucursales"?(l(),o("td",Ee,u(e.direccion),1)):r("",!0),n.value==="sucursales"?(l(),o("td",Fe,u(e.telefono||"Sin teléfono"),1)):r("",!0),t("td",Pe,[t("button",{onClick:p=>G(e),class:"text-orange-500 hover:text-orange-700 mr-2"},s[17]||(s[17]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})],-1)]),8,Le),t("button",{onClick:p=>Q(e.id),class:"text-red-500 hover:text-red-700"},s[18]||(s[18]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)]),8,He)])]))),128))])])]),_.value?(l(),o("div",Re,[t("div",qe,[t("h2",Oe,u(i.value.id?"Editar":"Agregar")+" "+u(A.value),1),t("form",{onSubmit:K(q,["prevent"]),class:"space-y-4"},[n.value==="users"?(l(),o("div",Ge,[v(t("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>i.value.name=e),placeholder:"Nombre",class:"w-full px-3 py-2 border rounded"},null,512),[[m,i.value.name]]),d.value.name?(l(),o("span",Qe,u(d.value.name),1)):r("",!0),v(t("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>i.value.apellido_p=e),placeholder:"Apellido Paterno",class:"mt-2 w-full px-3 py-2 border rounded"},null,512),[[m,i.value.apellido_p]]),d.value.apellido_p?(l(),o("span",Je,u(d.value.apellido_p),1)):r("",!0),v(t("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>i.value.apellido_m=e),placeholder:"Apellido Materno",class:"mt-2 w-full px-3 py-2 border rounded"},null,512),[[m,i.value.apellido_m]]),d.value.apellido_m?(l(),o("span",Ke,u(d.value.apellido_m),1)):r("",!0),v(t("input",{"onUpdate:modelValue":s[3]||(s[3]=e=>i.value.tel=e),placeholder:"Teléfono",class:"w-full px-3 py-2 border mt-2 rounded"},null,512),[[m,i.value.tel]]),d.value.tel?(l(),o("span",We,u(d.value.tel),1)):r("",!0),t("div",Xe,[t("div",Ye,[s[19]||(s[19]=t("label",{for:"inicio_contrato",class:"block text-sm font-medium text-gray-700"},"Inicio de Contrato",-1)),v(t("input",{"onUpdate:modelValue":s[4]||(s[4]=e=>i.value.inicio_contrato=e),type:"date",id:"inicio_contrato",class:"mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[m,i.value.inicio_contrato]]),d.value.inicio_contrato?(l(),o("span",Ze,u(d.value.inicio_contrato),1)):r("",!0)]),t("div",es,[s[20]||(s[20]=t("label",{for:"fin_contrato",class:"block text-sm font-medium text-gray-700"},"Fin de Contrato",-1)),v(t("input",{"onUpdate:modelValue":s[5]||(s[5]=e=>i.value.fin_contrato=e),type:"date",id:"fin_contrato",class:"mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[m,i.value.fin_contrato]]),d.value.fin_contrato?(l(),o("span",ss,u(d.value.fin_contrato),1)):r("",!0)])]),v(t("input",{"onUpdate:modelValue":s[6]||(s[6]=e=>i.value.email=e),type:"text",placeholder:"Matricula",class:"mt-2 w-full px-3 py-2 border rounded"},null,512),[[m,i.value.email]]),d.value.email?(l(),o("span",ts,u(d.value.email),1)):r("",!0),v(t("input",{"onUpdate:modelValue":s[7]||(s[7]=e=>i.value.password=e),type:"password",placeholder:"Contraseña",class:"mt-2 w-full px-3 py-2 border rounded"},null,512),[[m,i.value.password]]),d.value.password?(l(),o("span",ls,u(d.value.password),1)):r("",!0),v(t("select",{"onUpdate:modelValue":s[8]||(s[8]=e=>i.value.sucursal_id=e),class:"mt-2 w-full px-3 py-2 border rounded"},[s[21]||(s[21]=t("option",{value:""},"Seleccionar Sucursal",-1)),(l(!0),o(h,null,g(R.value,e=>(l(),o("option",{key:e.id,value:e.id},u(e.nombre),9,os))),128))],512),[[D,i.value.sucursal_id]]),d.value.sucursal_id?(l(),o("span",rs,u(d.value.sucursal_id),1)):r("",!0),v(t("select",{"onUpdate:modelValue":s[9]||(s[9]=e=>i.value.role=e),class:"mt-2 w-full px-3 py-2 border rounded"},[s[22]||(s[22]=t("option",{value:""},"Seleccionar Rol",-1)),(l(!0),o(h,null,g(H.value,e=>(l(),o("option",{key:e.id,value:e.name},u(e.name),9,as))),128))],512),[[D,i.value.role]]),t("div",ns,[v(t("input",{"onUpdate:modelValue":s[10]||(s[10]=e=>i.value.active=e),"true-value":1,"false-value":0,type:"checkbox",id:"active",class:"form-checkbox h-5 w-5 text-orange-500"},null,512),[[W,i.value.active]]),s[23]||(s[23]=t("label",{for:"active",class:"ml-2 text-sm font-medium text-gray-700"},"Activo",-1))]),d.value.role?(l(),o("span",us,u(d.value.role),1)):r("",!0)])):n.value==="sucursales"?(l(),o("div",is,[v(t("input",{"onUpdate:modelValue":s[11]||(s[11]=e=>i.value.nombre=e),placeholder:"Nombre de Sucursal",class:"w-full px-3 py-2 border rounded"},null,512),[[m,i.value.nombre]]),d.value.nombre?(l(),o("span",ds,u(d.value.nombre),1)):r("",!0),v(t("input",{"onUpdate:modelValue":s[12]||(s[12]=e=>i.value.direccion=e),placeholder:"Dirección",class:"mt-2 w-full px-3 py-2 border rounded"},null,512),[[m,i.value.direccion]]),d.value.direccion?(l(),o("span",cs,u(d.value.direccion),1)):r("",!0),v(t("input",{"onUpdate:modelValue":s[13]||(s[13]=e=>i.value.telefono=e),placeholder:"Teléfono",class:"mt-2 w-full px-3 py-2 border rounded"},null,512),[[m,i.value.telefono]]),d.value.telefono?(l(),o("span",ps,u(d.value.telefono),1)):r("",!0),s[24]||(s[24]=t("label",{for:"credenciales",class:"pt-4 font-semibold"},"Credenciales de inicio de sesión",-1)),v(t("input",{"onUpdate:modelValue":s[14]||(s[14]=e=>i.value.email=e),placeholder:"Matricula",class:"mt-2 w-full px-3 py-2 border rounded"},null,512),[[m,i.value.email]]),d.value.email?(l(),o("span",vs,u(d.value.email),1)):r("",!0),v(t("input",{"onUpdate:modelValue":s[15]||(s[15]=e=>i.value.password=e),placeholder:"Contraseña",class:"mt-2 w-full px-3 py-2 border rounded"},null,512),[[m,i.value.password]]),d.value.password?(l(),o("span",ms,u(d.value.password),1)):r("",!0)])):r("",!0),t("div",_s,[t("button",bs,u(i.value.id?"Actualizar":"Agregar"),1),t("button",{onClick:T,type:"button",class:"ml-2 bg-gray-300 text-gray-800 px-4 py-2 rounded hover:bg-gray-400 transition-colors duration-200 ease-in-out"}," Cancelar ")])],32)])])):r("",!0)])):r("",!0)}},ys={class:"py-6"},fs={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 p-2 md:p-8"},hs={class:"bg-white overflow-hidden shadow-xl rounded-xl"},Ss={__name:"index",setup(x){const{props:c}=F();return console.log(c.user.roles[0]),(_,y)=>U(c).user.roles[0]!=="trabajador"?(l(),V(J,{key:0,title:"Tablero principal"},{default:X(()=>[t("div",ys,[t("div",fs,[t("div",hs,[j(xs)])])])]),_:1})):r("",!0)}};export{Ss as default};
