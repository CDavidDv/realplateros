import{Q as ee,d as g,p as J,o as r,e as a,a as e,j as y,l as K,v as _,f as u,g as H,t as d,F as S,h as z,n as te,b as R,u as C,z as E,D as re,k as ae,c as le,w as ne}from"./app-FMxBDxtY.js";import{S as G,_ as ie}from"./AppLayout-ClqVWiKA.js";import{_ as ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{c as de}from"./createLucideIcon-DLBmlru8.js";/**
 * @license lucide-vue-next v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=de("XIcon",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ce={class:"min-h-screen pt-10 no-print"},pe={class:"max-w-5xl mx-auto bg-white rounded-lg p-1"},ve={class:"mb-6 border-b pb-4"},ge={class:"flex gap-5 justify-between items-center flex-col md:flex-row"},fe={class:"flex gap-4 items-center no-print"},xe={key:0,class:"flex flex-col gap-2 items-center"},me={class:"flex flex-col md:flex-row gap-3 items-center"},be={class:"flex gap-5"},ye={class:"grid grid-cols-2 gap-4"},_e={class:"capitalize"},he={class:"border-b border-gray-200 overflow-scroll"},we={class:"-mb-px flex space-x-8"},ke=["onClick"],$e={class:"mt-6 overflow-scroll"},Ce={class:"min-w-full divide-y divide-gray-200"},Se={key:0,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},Ee={key:1,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},Te={key:2,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},Ve={key:3,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},Ie={key:4,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},Ue={key:5,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},Ne={class:"bg-white divide-y divide-gray-200"},Be={key:0},ze={class:"px-6 py-4 whitespace-nowrap"},je={key:0,class:"flex gap-2"},Ae=["onUpdate:modelValue"],De=["onClick"],Ge={class:"ml-5 text-sm text-gray-500"},Me={key:0,class:"px-6 py-4"},Fe={key:1,class:"px-6 py-4"},Le=["onUpdate:modelValue","onInput"],Pe={key:1},He={key:2,class:"px-6 py-4 font-medium"},Re={key:3,class:"px-6 py-4"},Oe={key:4,class:"px-6 py-4"},qe={key:5,class:"px-6 py-4"},Qe=["onUpdate:modelValue"],Xe={key:0},We={key:0,class:"mt-6 flex justify-end"},Je=["disabled"],Ke={key:1,class:"mt-6 flex justify-end no-print"},Ye=["disabled"],Ze=["disabled"],et={id:"print-all",class:"print-all-tabs"},tt={class:"mb-8"},st={class:"text-xl font-bold mb-4 capitalize"},ot={class:"min-w-full divide-y divide-gray-200"},rt={key:0,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},at={key:1,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},lt={key:2,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},nt={key:3,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},it={key:4,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},ut={key:5,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},dt={class:"px-6 py-4 whitespace-nowrap"},ct={key:0,class:"flex gap-2"},pt={class:"w-48"},vt={class:"ml-5 text-sm text-gray-500"},gt={key:0,class:"px-6 py-4"},ft={key:1,class:"px-6 py-4"},xt=["onUpdate:modelValue","onInput"],mt={key:1},bt={key:2,class:"px-6 py-4 font-medium"},yt={key:3,class:"px-6 py-4"},_t={key:4,class:"px-6 py-4"},ht={key:5,class:"px-6 py-4"},wt={class:"w-fit rounded-md border-gray-300 shadow-sm text-center"},kt={__name:"RegistroInventario",setup(Y){const{props:v}=ee(),j=(o,s)=>{G.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,customClass:"no-print",didOpen:t=>{t.addEventListener("mouseenter",G.stopTimer),t.addEventListener("mouseleave",G.resumeTimer)}}).fire({icon:o,title:s})},w=g(null),U=g(null),M=g(null),T=g("day"),A=g(v.inventario),V=g(v.registros),h=g(v.gastos||[]),O=g(v.categorias),n=g("bebida"),b=g(!1),q=g(v.user.roles[0]==="almacen"),f=g(!1),Q=()=>{w.value=null,U.value=null,M.value=null,f.value=!1,E.get("/inventario",{},{preserveScroll:!0})},p=()=>{let o=T.value,s=null;if(o==="day"?s=w.value:o==="week"?s=U.value:o==="month"&&(s=M.value),!s){j("error","Debes seleccionar una fecha");return}E.post("/inventario/filtro",{filter:o,value:s},{preserveScroll:!0,onSuccess(t){console.log("Respuesta completa del servidor:",t.props),V.value=t.props.registros,A.value=t.props.inventario,h.value=t.props.gastos;const N=new Map(t.props.registros.map(m=>[m.inventario_id,m]));k.value=A.value.filter(m=>m.nombre!=="-").map(m=>{const P=N.get(m.id)||{};return{...m,existe:P.existe||0,entra:P.entra||0,total:P.total||0,vende:P.vende||0,sobra:P.sobra||0,costo:P.precio||(m==null?void 0:m.costo)||0}}),f.value=!0,j("success","Filtro actualizado correctamente")},onError(t){console.error("Error al obtener datos:",t),j("error",t.props.flash.error||"Error al obtener datos con este filtro"),error.value="Ocurrió un error al obtener los datos. Inténtalo de nuevo.",isLoading.value=!1}})},B=J(()=>{var o,s;return console.log("Filtrando productos con activeTab:",n.value),n.value==="gastos"?h.value:n.value==="pastes"||n.value==="sobrantes"?(o=k==null?void 0:k.value)==null?void 0:o.filter(t=>t.tipo==="pastes"||t.tipo==="empanadas saladas"||t.tipo==="empanadas dulces"):(s=k==null?void 0:k.value)==null?void 0:s.filter(t=>t.tipo===n.value)});async function F(){try{b.value=!0;const o={sobrantes:k.value.filter(s=>s.existe>0).map(s=>({inventario_id:s.id,sucursal_id:v.sucursal_id,nombre:s.nombre,cantidad:s.existe}))};E.post("/sobrantes",o,{preserveScroll:!0,preserveState:!0,onSuccess:()=>{Toast.fire({icon:"success",title:"Sobrantes guardados exitosamente"})},onError:s=>{console.error("Error al guardar sobrantes:",s),Toast.fire({icon:"error",title:"Error al guardar los sobrantes"})}})}catch(o){console.error("Error al guardar sobrantes:",o),Toast.fire({icon:"error",title:"Error al guardar los sobrantes"})}finally{b.value=!1}}function X(){h.value.push({nombre:"",costo:0})}function x(o){h.value.splice(o,1)}const W=[...O.value.filter(o=>o.tipo!=="empanadas saladas"&&o.tipo!=="empanadas dulces").map(o=>o.tipo==="masa"?{name:"Tortillas y Bolas",id:o.tipo}:o.tipo==="pastes"?{name:"Pastes / Empanadas",id:o.tipo}:{id:o.tipo,name:o.tipo}),...q.value?[]:[{id:"gastos",name:"Gastos generales"},{id:"sobrantes",name:"Sobrantes"}]],k=g(A.value.filter(o=>o.nombre!=="-").map(o=>{var s,t;return{...o,existe:((s=V.value[o.id-1])==null?void 0:s.existe)||(o==null?void 0:o.existe)||0,entra:0,total:null,sobra:(t=V.value[o.id-1])==null?void 0:t.existe,costo:(o==null?void 0:o.costo)||0}})),L=J(()=>n.value==="bebida"||n.value==="extras"||n.value==="pastes"),$=o=>{const s=v.ventas.find(t=>t.producto_id===o);return s?s.total_vendido:0},D=o=>f.value?o.total:i(o)+($(o)||0)+o.entra,c=o=>f.value?o.sobra:D(o)-$(o.id),l=o=>{o.total=(o.existe||0)+(o.entra||0);const s=$(o.id);o.sobra=o.total-s};function i(o){const s=$(o.id);return f.value?o.existe+Number(s):o.cantidad+Number(s)}async function I(){try{b.value=!0;const o={gastos:h.value.map(s=>({id:s.id||null,sucursal_id:s.sucursal_id||0,nombre:s.nombre,costo:s.costo||0}))};E.post("/gastos",o,{preserveScroll:!0,preserveState:!1,onSuccess:s=>{Toast.fire({icon:"success",title:"Gastos guardados exitosamente"}),n.value="gastos",h.value=s.props.gastos},onError:s=>{console.error("Error al guardar:",s),Toast.fire({icon:"error",title:"Error al guardar los gastos"})}})}catch(o){console.error("Error al guardar:",o),Toast.fire({icon:"error",title:"Error al guardar los gastos"})}finally{b.value=!1}}async function se(){try{b.value=!0;const o={productos:k.value.map(s=>({id:s.id,existe:s.existe||0,entra:s.entra||0,total:D(s),vende:Number($(s.id)),costo:s.costo||0,sobra:c(s)}))};E.post("/registro",{registros:o},{preserveScroll:!0,preserveState:!1,replace:!0,onSuccess:()=>{console.log("Registro guardado exitosamente")},onError:s=>{console.error("Error al guardar:",s)}}),Toast.fire({icon:"success",title:"Registro guardado exitosamente"})}catch(o){console.error("Error al guardar:",o),Toast.fire({icon:"error",title:"Error al guardar el registro"})}finally{b.value=!1}}const oe=()=>{window.print()};return(o,s)=>(r(),a(S,null,[e("div",ce,[e("div",pe,[e("div",ve,[e("div",ge,[s[8]||(s[8]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Registro de Inventario",-1)),e("div",fe,[o.$page.props.user.roles[0]!="trabajador"?(r(),a("div",xe,[e("div",me,[s[6]||(s[6]=e("label",{for:"fecha"},"Buscar por:",-1)),e("div",be,[y(e("select",{class:"rounded",id:"filter","onUpdate:modelValue":s[0]||(s[0]=t=>T.value=t)},s[5]||(s[5]=[e("option",{value:"day"},"Día",-1),e("option",{value:"week"},"Semana",-1),e("option",{value:"month"},"Mes",-1)]),512),[[K,T.value]]),T.value==="day"?y((r(),a("input",{key:0,class:"w-fit h-fit rounded",id:"valueSelect",type:"date","onUpdate:modelValue":s[1]||(s[1]=t=>w.value=t)},null,512)),[[_,w.value]]):u("",!0),T.value==="week"?y((r(),a("input",{key:1,class:"w-fit h-fit rounded",id:"valueSelect",type:"week","onUpdate:modelValue":s[2]||(s[2]=t=>U.value=t)},null,512)),[[_,U.value]]):u("",!0),T.value==="month"?y((r(),a("input",{key:2,class:"w-fit h-fit rounded",id:"valueSelect",type:"month","onUpdate:modelValue":s[3]||(s[3]=t=>M.value=t)},null,512)),[[_,M.value]]):u("",!0)])]),e("div",ye,[e("button",{onClick:p,class:"no-print bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",type:"button"},"Buscar"),e("button",{onClick:Q,class:"no-print bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded",type:"button"},"Limpiar filtro"),e("button",{onClick:oe,class:"bg-green-500 text-white px-4 py-2 rounded no-print"},[s[7]||(s[7]=H(" Imprimir inventario - ")),e("span",_e,d(n.value),1)])])])):u("",!0)])])]),e("div",he,[e("nav",we,[(r(),a(S,null,z(W,t=>e("button",{key:t.id,onClick:N=>n.value=t.id,class:te(["whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm capitalize",n.value===t.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},d(t.name),11,ke)),64))])]),e("div",$e,[e("table",Ce,[e("thead",null,[e("tr",null,[s[9]||(s[9]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Nombre",-1)),n.value==="gastos"?(r(),a("th",Se," Costo ")):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("th",Ee," Existe ")):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("th",Te," Entra ")):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("th",Ve," Total ")):u("",!0),L.value?(r(),a("th",Ie," Vendidos ")):u("",!0),n.value!=="gastos"?(r(),a("th",Ue," Sobra ")):u("",!0)])]),e("tbody",Ne,[n.value==="gastos"?(r(),a("tr",Be,[e("td",{colspan:"2",class:"px-6 py-4"},[e("div",{class:""},[e("button",{onClick:X,class:"text-blue-600 hover:text-blue-800"}," + Agregar nuevo gasto ")])])])):u("",!0),(r(!0),a(S,null,z(B.value,(t,N)=>(r(),a("tr",{key:N},[e("td",ze,[n.value==="gastos"?(r(),a("div",je,[y(e("input",{type:"text","onUpdate:modelValue":m=>t.nombre=m,class:"w-48 rounded-md border-gray-300 shadow-sm",placeholder:"Nombre del gasto"},null,8,Ae),[[_,t.nombre]]),e("button",{onClick:m=>x(N),class:"text-red-600 no-print hover:text-red-800"},[R(C(Z),{class:"no-print"})],8,De)])):(r(),a(S,{key:1},[e("h1",null,d(t.nombre),1),e("span",Ge,d(t.detalle),1)],64))]),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("td",Me,d(f.value?t.total-t.entra:i(t)),1)):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("td",Fe,[f.value?(r(),a("div",Pe,d(f.value?t.entra:0),1)):y((r(),a("input",{key:0,"onUpdate:modelValue":m=>t.entra=m,type:"number",min:"0",placeholder:"0",class:"w-20 rounded-md border-gray-300 shadow-sm text-center",onInput:m=>l(t)},null,40,Le)),[[_,t.entra,void 0,{number:!0}]])])):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("td",He,d(f.value?t.total:D(t)),1)):u("",!0),L.value&&n.value!=="sobrantes"?(r(),a("td",Re,d(f.value?t.vende:$(t.id)),1)):u("",!0),n.value!=="gastos"?(r(),a("td",Oe,d(f.value?t.sobra:c(t)),1)):u("",!0),n.value==="gastos"&&n.value!=="sobrantes"?(r(),a("td",qe,[y(e("input",{"onUpdate:modelValue":m=>t.costo=m,type:"number",min:"0",placeholder:"0",class:"w-fit rounded-md border-gray-300 shadow-sm text-center"},null,8,Qe),[[_,t.costo,void 0,{number:!0}]])])):u("",!0)]))),128))])])]),C(v).user.roles[0]!=="supervisor"?(r(),a("div",Xe,[n.value==="sobrantes"?(r(),a("div",We,[e("button",{onClick:F,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",disabled:b.value},d(b.value?"Guardando...":"Guardar Sobrantes"),9,Je)])):(r(),a("div",Ke,[n.value==="gastos"?(r(),a("button",{key:0,onClick:I,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",disabled:b.value},d(b.value?"Guardando...":"Guardar Gastos"),9,Ye)):(r(),a("button",{key:1,onClick:se,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",disabled:b.value},d(b.value?"Guardando...":"Guardar Registro"),9,Ze))]))])):u("",!0)])]),e("div",et,[e("div",tt,[e("h2",st,d(n.value),1),e("table",ot,[e("thead",null,[e("tr",null,[s[10]||(s[10]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Nombre",-1)),n.value==="gastos"?(r(),a("th",rt," Costo ")):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("th",at," Existe ")):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("th",lt," Entra ")):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("th",nt," Total ")):u("",!0),L.value?(r(),a("th",it," Vendidos ")):u("",!0),n.value!=="gastos"?(r(),a("th",ut," Sobra ")):u("",!0)])]),e("tbody",null,[(r(!0),a(S,null,z(B.value,t=>(r(),a("tr",{key:t.index},[e("td",dt,[n.value==="gastos"?(r(),a("div",ct,[e("span",pt,d(t.nombre),1),e("button",{onClick:s[4]||(s[4]=N=>x(o.index)),class:"text-red-600 hover:text-red-800"},[R(C(Z),{class:"no-print"})])])):(r(),a(S,{key:1},[e("h1",null,d(t.nombre),1),e("span",vt,d(t.detalle),1)],64))]),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("td",gt,d(f.value?t.total-t.entra:i(t)),1)):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("td",ft,[f.value?(r(),a("div",mt,d(f.value?t.entra:0),1)):y((r(),a("input",{key:0,"onUpdate:modelValue":N=>t.entra=N,type:"number",min:"0",placeholder:"0",class:"w-20 rounded-md border-gray-300 shadow-sm text-center",onInput:N=>l(t)},null,40,xt)),[[_,t.entra,void 0,{number:!0}]])])):u("",!0),n.value!=="gastos"&&n.value!=="sobrantes"?(r(),a("td",bt,d(f.value?t.total:D(t)),1)):u("",!0),L.value&&n.value!=="sobrantes"?(r(),a("td",yt,d(f.value?t.vende:$(t.id)),1)):u("",!0),n.value!=="gastos"?(r(),a("td",_t,d(f.value?t.sobra:c(t)),1)):u("",!0),n.value==="gastos"&&n.value!=="sobrantes"?(r(),a("td",ht,[e("span",wt,d(t.costo),1)])):u("",!0)]))),128))])])])])],64))}},$t=ue(kt,[["__scopeId","data-v-afa01932"]]),Ct={class:"container mx-auto p-8 md:p-10"},St={class:"space-y-4 mb-5 no-print"},Et={class:"flex justify-between items-center"},Tt={class:"flex items-center space-x-2"},Vt={class:"text-lg font-semibold text-gray-800"},It={class:"text-gray-600 text-sm"},Ut={class:"text-gray-600 text-sm"},Nt={class:"font-medium text-gray-800 capitalize"},Bt={class:"text-sm text-gray-700"},zt={class:"mt-2 space-y-1"},jt={class:"text-sm text-gray-700 space-y-1 pl-4 list-disc"},At={key:0,class:"text-xs"},Dt={class:"flex justify-end"},Gt=["onClick"],Mt={key:0,class:"no-print flex flex-col md:flex-row gap-10 w-full"},Ft={key:0,class:"md:w-4/12 w-full"},Lt={class:"bg-white shadow rounded-lg p-6 mb-6"},Pt={class:"text-xl font-semibold mb-4"},Ht=["value"],Rt={class:"flex justify-end space-x-2"},Ot={type:"submit",class:"px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500"},qt={key:0,class:"w-full"},Qt={class:"mb-4"},Xt={class:"bg-white shadow rounded-lg overflow-auto h-screen"},Wt={class:"min-w-full divide-y divide-gray-200"},Jt={class:"bg-gray-50"},Kt={key:0,scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},Yt={class:"bg-white divide-y divide-gray-200"},Zt={class:"py-1 px-2 whitespace bg-gray-50"},es={class:"py-1 px-2 whitespace-nowrap"},ts={class:"py-1 px-2 whitespace bg-gray-50"},ss={class:"py-1 px-2 whitespace-nowrap"},os={class:"py-1 px-2 whitespace-nowrap bg-gray-50"},rs={key:0,class:"py-1 px-2 whitespace-nowrap text-sm font-medium flex flex-col gap-1 place-items-center"},as=["onClick"],ls=["onClick"],ns={key:1,class:"no-print fixed inset-0 bg-gray-900 bg-opacity-50 flex justify-center items-center z-50"},is={class:"bg-white p-6 rounded-lg shadow-lg w-96"},us={key:2,class:"fixed inset-0 bg-gray-900 bg-opacity-50 flex justify-center items-center z-50"},ds={class:"bg-white p-6 rounded-lg shadow-lg w-96"},cs=["value"],ps={__name:"Inventario",setup(Y){var D;const{props:v}=ee(),j=g(v.tickets),w=g((D=v==null?void 0:v.inventario)==null?void 0:D.filter(c=>c.nombre!="-")),U=g(v.categorias),M=g(v.user.roles[0]==="almacen"),T=g(!1),A=g(!1),V=g(),h=g(""),O=()=>{T.value=!0},n=()=>{A.value=!0},b=()=>{T.value=!1,A.value=!1,h.value=""},q=()=>{h.value.trim()?(E.post("/categorias",{tipo:h.value},{preserveScroll:!0,preserveState:!1,replace:!0,onSuccess:c=>{x.fire({icon:"success",title:"Categoría agregada correctamente"}),U.value=c.props.categorias},onError:c=>{x.fire({icon:"error",title:"Hubo un problema al agregar la categoría"})}}),b()):x.fire({icon:"error",title:"Por favor, ingresa un nombre para la categoría"})},f=c=>{E.put(`/tickets/${c}`,{estado:"completado"},{preserveScroll:!0,preserveState:!1,replace:!0,onSuccess:l=>{x.fire({icon:"success",title:"Ticket completado correctamente"}),j.value=l.props.tickets},onError:l=>{x.fire({icon:"error",title:"Hubo un problema al completar el ticket"}),console.error(l)}})},Q=()=>{var c;(c=V==null?void 0:V.value)!=null&&c.tipo.trim()?(E.delete(`/categorias/${V.value.tipo}`,{preserveScroll:!0,preserveState:!1,replace:!0,onSuccess:l=>{l.props.flash.success?(x.fire({icon:"success",title:"Categoría eliminada correctamente"}),U.value=l.props.categorias):x.fire({icon:"error",title:"La categoría tiene mas de un elemento aún en alguna sucursal"})},onError:l=>{x.fire({icon:"error",title:"Hubo un problema al eliminar la categoría"})}}),b()):x.fire({icon:"error",title:"Por favor, selecciona una categoría"})},p=re({id:null,nombre:"",detalle:"",tipo:"",cantidad:0,precio:0}),B=g(!1),F=g(""),X=J(()=>{var c;return(c=w==null?void 0:w.value)==null?void 0:c.filter(l=>l.nombre.toLowerCase().includes(F.value.toLowerCase())||l.tipo.toLowerCase().includes(F.value.toLowerCase()))}),x=G.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1500,timerProgressBar:!0,didOpen:c=>{c.onmouseenter=G.stopTimer,c.onmouseleave=G.resumeTimer}}),W=()=>{B.value?E.put(`/inventario/${p.id}`,{nombre:p.nombre,detalle:p.detalle,tipo:p.tipo,cantidad:p.cantidad,precio:p.precio},{preserveScroll:!0,preserveState:!1,replace:!0,onSuccess:c=>{x.fire({icon:"success",title:"Actualizado correctamente"}),w.value=c.props.inventario,$()},onError:c=>{x.fire({icon:"error",title:"Hubo un problema al actualizar el ítem"})}}):E.post("/inventario",{nombre:p.nombre,detalle:p.detalle,tipo:p.tipo,cantidad:p.cantidad,precio:p.precio},{preserveScroll:!0,preserveState:!1,replace:!0,onSuccess:c=>{x.fire({icon:"success",title:"Agregado correctamente"}),w.value=c.props.inventario,$()},onError:c=>{x.fire({icon:"error",title:"Hubo un problema al agregar el ítem"})}})},k=c=>{Object.assign(p,c),B.value=!0},L=c=>{G.fire({title:"¿Estás seguro?",text:"¡No podrás revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#e66f23",cancelButtonColor:"#3085d6",confirmButtonText:"Sí, eliminarlo",cancelButtonText:"Cancelar"}).then(l=>{l.isConfirmed&&E.delete(`/inventario/${c}`,{preserveScroll:!0,preserveState:!1,replace:!0,onSuccess:i=>{x.fire({icon:"success",title:"Eliminado correctamente"}),w.value=i.props.inventario},onError:i=>{x.fire({icon:"error",title:"Hubo un problema al eliminar el ítem"})}})})},$=()=>{Object.assign(p,{id:null,nombre:"",detalle:"",tipo:"",cantidad:0,precio:0}),B.value=!1};return(c,l)=>(r(),a("div",Ct,[l[24]||(l[24]=e("h1",{class:"text-2xl font-bold mb-4"},"Gestión de Inventario",-1)),e("div",St,[(r(!0),a(S,null,z(j.value,i=>(r(),a("div",{key:i.id,class:"flex flex-col gap-4 p-4 border rounded-lg shadow-sm bg-white"},[e("div",Et,[e("div",Tt,[e("span",Vt,"Ticket #"+d(i.id),1),e("span",It,"Fecha: "+d(i.created_at.split("T")[0]),1)]),e("div",Ut,[l[9]||(l[9]=H(" Estado: ")),e("span",Nt,d(i.estado),1)])]),e("div",null,[e("div",Bt,[l[10]||(l[10]=e("span",{class:"font-medium"},"Hora de salida:",-1)),H(" "+d(i.hora_salida||"N/A"),1)]),e("div",zt,[l[11]||(l[11]=e("h4",{class:"text-sm font-medium text-gray-800"},"Productos asignados:",-1)),e("ul",jt,[(r(!0),a(S,null,z(i.ticket_productos_asignacion,I=>(r(),a("li",{class:"flex gap-1 items-center",key:I.id},[H(d(I.cantidad)+"x "+d(I.producto.nombre),1),I.producto.detalle?(r(),a("p",At,"- "+d(I.producto.detalle),1)):u("",!0)]))),128))])])]),e("div",Dt,[e("button",{onClick:I=>f(i.id),class:"bg-orange-500 text-white px-4 py-2 rounded-md hover:bg-orange-600 focus:outline-none focus:ring focus:ring-orange-200 focus:ring-opacity-50"}," Completar ",8,Gt)])]))),128))]),C(v).user.roles[0]==="admin"||C(v).user.roles[0]==="sucursal"||C(v).user.roles[0]==="almacen"||C(v).user.roles[0]==="supervisor"?(r(),a("div",Mt,[C(v).user.roles[0]!=="supervisor"?(r(),a("div",Ft,[e("div",Lt,[e("h2",Pt,d(B.value?"Editar Item":"Agregar Nuevo Item"),1),e("form",{onSubmit:ae(W,["prevent"]),class:"space-y-4"},[e("div",null,[l[12]||(l[12]=e("label",{for:"itemName",class:"block text-sm font-medium text-gray-700"},"Nombre del Item",-1)),y(e("input",{"onUpdate:modelValue":l[0]||(l[0]=i=>p.nombre=i),id:"itemName",type:"text",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50"},null,512),[[_,p.nombre]])]),e("div",null,[l[13]||(l[13]=e("label",{for:"itemCategory",class:"block text-sm font-medium text-gray-700"},"Categoría",-1)),y(e("select",{"onUpdate:modelValue":l[1]||(l[1]=i=>p.tipo=i),id:"itemCategory",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50"},[(r(!0),a(S,null,z(U.value,i=>(r(),a("option",{key:i.id,class:"capitalize",value:i.tipo},d(i.tipo),9,Ht))),128))],512),[[K,p.tipo]])]),e("div",null,[l[14]||(l[14]=e("label",{for:"itemDetalle",class:"block text-sm font-medium text-gray-700"},"Detalle del item",-1)),y(e("input",{"onUpdate:modelValue":l[2]||(l[2]=i=>p.detalle=i),id:"itemDetalle",type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50"},null,512),[[_,p.detalle]])]),e("div",null,[l[15]||(l[15]=e("label",{for:"itemQuantity",class:"block text-sm font-medium text-gray-700"},"Cantidad",-1)),y(e("input",{"onUpdate:modelValue":l[3]||(l[3]=i=>p.cantidad=i),id:"itemQuantity",type:"number",required:"",min:"0",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50"},null,512),[[_,p.cantidad,void 0,{number:!0}]])]),e("div",null,[l[16]||(l[16]=e("label",{for:"itemPrice",class:"block text-sm font-medium text-gray-700"},"Precio Unitario",-1)),y(e("input",{"onUpdate:modelValue":l[4]||(l[4]=i=>p.precio=i),id:"itemPrice",type:"number",required:"",min:"0",step:"0.01",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50"},null,512),[[_,p.precio,void 0,{number:!0}]])]),e("div",Rt,[e("button",{type:"button",onClick:$,class:"px-4 py-2 border border-transparent text-sm font-medium rounded-md text-gray-700 bg-gray-200 hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500"}," Cancelar "),e("button",Ot,d(B.value?"Actualizar":"Agregar"),1)])],32)]),M.value?(r(),a("div",qt,[e("button",{onClick:O,class:"bg-orange-500 w-full hover:bg-orange-700 text-white font-bold py-2 px-4 rounded mb-4"}," Agregar nueva categoría "),e("button",{onClick:n,class:"bg-red-500 w-full hover:bg-red-700 text-white font-bold py-2 px-4 rounded mb-4"}," Eliminar categoría ")])):u("",!0)])):u("",!0),e("div",{class:te([C(v).user.roles[0]==="supervisor"?"w-full":"md:w-8/12 w-full"])},[e("div",Qt,[y(e("input",{"onUpdate:modelValue":l[5]||(l[5]=i=>F.value=i),type:"text",placeholder:"Buscar en el inventario...",class:"w-full px-4 py-2 rounded-md border-gray-300 shadow-sm focus:border-orange-300 focus:ring focus:ring-orange-200 focus:ring-opacity-50",onInput:l[6]||(l[6]=(...i)=>c.searchInventory&&c.searchInventory(...i))},null,544),[[_,F.value]])]),e("div",Xt,[e("table",Wt,[e("thead",Jt,[e("tr",null,[l[17]||(l[17]=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nombre",-1)),l[18]||(l[18]=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Categoría",-1)),l[19]||(l[19]=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Detalle",-1)),l[20]||(l[20]=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Existentes",-1)),l[21]||(l[21]=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Precio",-1)),C(v).user.roles[0]!=="supervisor"?(r(),a("th",Kt," Acciones")):u("",!0)])]),e("tbody",Yt,[(r(!0),a(S,null,z(X.value,i=>(r(),a("tr",{key:i.id,class:"text-center"},[e("td",Zt,d(i.nombre),1),e("td",es,d(i.tipo),1),e("td",ts,d(i.detalle),1),e("td",ss,d(i.cantidad),1),e("td",os,"$"+d(i.precio),1),C(v).user.roles[0]!=="supervisor"?(r(),a("td",rs,[e("button",{onClick:I=>k(i),class:"bg-orange-600 py-1 px-2 text-white rounded-lg hover:bg-orange-900 mr-2"},"Editar",8,as),e("button",{onClick:I=>L(i.id),class:"bg-red-600 py-1 px-2 text-white rounded-lg hover:bg-red-900"},"Eliminar",8,ls)])):u("",!0)]))),128))])])])],2)])):u("",!0),R($t),T.value?(r(),a("div",ns,[e("div",is,[l[22]||(l[22]=e("h2",{class:"text-xl font-semibold mb-4"},"Agregar Categoría",-1)),y(e("input",{"onUpdate:modelValue":l[7]||(l[7]=i=>h.value=i),type:"text",placeholder:"Nombre de la categoría",class:"w-full mb-4 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"},null,512),[[_,h.value]]),e("div",{class:"flex justify-end space-x-2"},[e("button",{onClick:b,class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg"}," Cancelar "),e("button",{onClick:q,class:"px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg"}," Agregar ")])])])):u("",!0),A.value?(r(),a("div",us,[e("div",ds,[l[23]||(l[23]=e("h2",{class:"text-xl font-semibold mb-4"},"Eliminar Categoría",-1)),y(e("select",{"onUpdate:modelValue":l[8]||(l[8]=i=>V.value=i),class:"w-full mb-4 px-3 py-2 border rounded-lg capitalize focus:outline-none focus:ring-2 focus:ring-orange-500"},[(r(!0),a(S,null,z(U.value,i=>(r(),a("option",{key:i.id,value:i,class:"capitalize"},d(i.tipo),9,cs))),128))],512),[[K,V.value]]),e("div",{class:"flex justify-end space-x-2"},[e("button",{onClick:b,class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg"}," Cancelar "),e("button",{onClick:Q,class:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg"}," Eliminar ")])])])):u("",!0)]))}},vs={class:"py-6 px-2"},gs={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},fs={class:"bg-white overflow-hidden shadow-xl rounded-lg py-2"},_s={__name:"index",setup(Y){return(v,j)=>(r(),le(ie,{title:"Tablero principal"},{default:ne(()=>[e("div",vs,[e("div",gs,[e("div",fs,[R(ps)])])])]),_:1}))}};export{_s as default};
