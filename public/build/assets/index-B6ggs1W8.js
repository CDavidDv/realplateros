import{S,_ as ge}from"./AppLayout-BpRYJbwA.js";import{Q as oe,d,i as I,o as r,e as n,a as t,n as c,f as g,j as u,v as L,k as N,F as _,h,t as s,l as C,m as ve,p as me,g as ee,q as j,u as fe,c as ye,w as _e,b as he}from"./app-C2_hgsRO.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const we={class:"relative px-6 py-8 bg-white shadow-lg sm:rounded-3xl sm:p-12"},ke={key:0,class:"flex border-b border-gray-200 mb-6"},Ce={class:"mb-4 bg-gray-50 p-4 rounded-lg"},Se={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},Ne=["value"],Ve={class:"mt-4 flex justify-end"},je=["disabled"],Te={key:0},Ee={key:1},Fe={class:"overflow-x-auto"},Ae={class:"min-w-full bg-white border border-gray-200 rounded-lg"},Me={class:"px-4 py-3 border-b"},De={class:"text-sm font-medium text-gray-900"},$e={class:"text-xs text-gray-500"},Ue={class:"px-4 py-3 border-b text-sm text-gray-700"},Pe={class:"px-4 py-3 border-b text-sm text-gray-700"},Be={class:"px-4 py-3 border-b"},He={class:"px-4 py-3 border-b text-sm text-gray-700"},Ie={class:"px-4 py-3 border-b"},Le={key:0,class:"px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800"},Oe=["onClick"],ze={key:0},Re={class:"mb-6 bg-gray-50 p-4 rounded-lg"},qe={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},Ge=["value"],Qe=["value"],Xe={class:"mt-4 flex justify-end"},Ye=["disabled"],Je={key:0},Ke={key:1},We={class:"mb-6 grid grid-cols-2 md:grid-cols-4 gap-4"},Ze={class:"bg-blue-50 p-4 rounded-lg border border-blue-200"},to={class:"text-2xl font-bold text-blue-800"},eo={class:"bg-yellow-50 p-4 rounded-lg border border-yellow-200"},oo={class:"text-2xl font-bold text-yellow-800"},so={class:"text-sm text-yellow-600"},ao={class:"bg-green-50 p-4 rounded-lg border border-green-200"},ro={class:"text-2xl font-bold text-green-800"},no={class:"text-sm text-green-600"},lo={class:"bg-purple-50 p-4 rounded-lg border border-purple-200"},io={class:"text-2xl font-bold text-purple-800"},uo={class:"overflow-x-auto"},co={class:"min-w-full bg-white border border-gray-200 rounded-lg"},xo={class:"px-4 py-3 border-b"},po={class:"text-sm font-medium text-gray-900"},bo={class:"text-xs text-gray-500"},go={class:"px-4 py-3 border-b text-sm text-gray-700"},vo={class:"px-4 py-3 border-b text-sm text-gray-700"},mo={class:"px-4 py-3 border-b"},fo={class:"px-4 py-3 border-b"},yo={class:"px-4 py-3 border-b text-sm text-gray-700"},_o=["title"],ho={key:1},wo={key:0},ko={key:0,class:"mt-4 flex justify-center items-center space-x-2"},Co=["disabled"],So={class:"text-sm text-gray-600"},No=["disabled"],Vo={class:"mt-2 text-center text-sm text-gray-500"},jo={class:"mb-6 bg-gray-50 p-4 rounded-lg"},To={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Eo=["value"],Fo={class:"flex items-end gap-2"},Ao=["disabled"],Mo={key:0},Do={key:1},$o={class:"mb-6 grid grid-cols-2 md:grid-cols-4 gap-4"},Uo={class:"bg-yellow-50 p-4 rounded-lg border border-yellow-200"},Po={class:"text-xl font-bold text-yellow-800 truncate"},Bo={class:"text-sm text-yellow-600"},Ho={class:"bg-blue-50 p-4 rounded-lg border border-blue-200"},Io={class:"text-xl font-bold text-blue-800 truncate"},Lo={class:"text-sm text-blue-600"},Oo={class:"bg-orange-50 p-4 rounded-lg border border-orange-200"},zo={class:"text-xl font-bold text-orange-800 truncate"},Ro={class:"text-sm text-orange-600"},qo={class:"bg-purple-50 p-4 rounded-lg border border-purple-200"},Go={class:"text-xl font-bold text-purple-800"},Qo={class:"text-sm text-purple-600"},Xo={class:"overflow-x-auto"},Yo={class:"min-w-full bg-white border border-gray-200 rounded-lg"},Jo={class:"px-4 py-3 border-b"},Ko=["innerHTML"],Wo={class:"px-4 py-3 border-b"},Zo={class:"text-sm font-medium text-gray-900"},ts={class:"text-xs text-gray-500"},es={class:"px-4 py-3 border-b text-sm text-gray-700"},os={class:"px-4 py-3 border-b text-center"},ss={class:"px-4 py-3 border-b text-center text-sm text-gray-700"},as={class:"px-4 py-3 border-b text-center text-sm text-gray-700"},rs={class:"px-4 py-3 border-b text-center text-sm text-gray-700"},ns={class:"px-4 py-3 border-b text-center text-sm text-gray-700"},ls={class:"px-4 py-3 border-b text-center"},is=["onClick"],ds={key:0},us={class:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"},cs={class:"px-6 py-4 border-b border-gray-200 flex justify-between items-center"},xs={class:"text-lg font-semibold text-gray-900"},ps={key:0,class:"p-6"},bs={class:"mb-6"},gs={class:"text-gray-600"},vs={class:"text-gray-600"},ms={key:0,class:"mt-3 bg-yellow-50 border border-yellow-200 rounded-lg p-3"},fs={key:1,class:"mt-3 bg-blue-50 border border-blue-200 rounded-lg p-3"},ys={class:"bg-gray-50 rounded-lg p-3 text-center border border-gray-200"},_s={class:"bg-gray-50 rounded-lg p-3 text-center border border-gray-200"},hs={class:"bg-gray-50 rounded-lg p-3 text-center border border-gray-200"},ws={class:"bg-gray-50 rounded-lg p-3 text-center border border-gray-200"},ks={class:"max-h-64 overflow-y-auto"},Cs={key:0,class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-center"},Ss={key:1,class:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-center"},Ns={class:"grid grid-cols-2 gap-2 text-xs"},Vs={class:"bg-white rounded p-2 border border-blue-100"},js={class:"text-blue-700"},Ts={class:"bg-white rounded p-2 border border-blue-100"},Es={class:"text-blue-700"},Fs={class:"bg-white rounded p-2 border border-blue-100"},As={class:"text-blue-700"},Ms={class:"bg-white rounded p-2 border border-blue-100"},Ds={class:"text-blue-700"},$s={key:2},Us={class:"text-sm font-medium text-gray-900"},Ps={class:"text-xs text-gray-500"},Bs={class:"text-xs text-gray-400"},Hs={key:0,class:"text-gray-500 text-center py-4"},O=20,Is={__name:"ActividadPersonal",setup(se){var Y,J,K;const{props:x}=oe(),z=d(x.usuarios||[]),T=d(x.sucursales||[]),V=d(x.actividades||[]),w=d(x.resumen||{}),p=d({fecha_inicio:x.fechaInicio||new Date().toISOString().split("T")[0],fecha_fin:x.fechaFin||new Date().toISOString().split("T")[0],sucursal_id:null,usuario_id:null,tipo_actividad:null}),E=d(!1),v=d(1),F=I(()=>Math.ceil(V.value.length/O)),R=I(()=>{const a=(v.value-1)*O,e=a+O;return V.value.slice(a,e)}),ae=async()=>{E.value=!0,v.value=1;try{const a=await j.post("/actividad-personal/filtro",p.value);V.value=a.data.actividades,w.value=a.data.resumen}catch(a){console.error("Error al filtrar:",a),S.fire({icon:"error",title:"Error",text:"No se pudieron cargar las actividades",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}finally{E.value=!1}},m=d("actividades"),re=I(()=>{var f;const a=((f=x.auth)==null?void 0:f.user)||x.user;return((a==null?void 0:a.roles)||[]).some(y=>(typeof y=="string"?y:y==null?void 0:y.name)==="admin")}),ne=()=>{m.value="notificaciones",q()},P=d([]),A=d(!1),i=d({fecha_inicio:new Date().toISOString().split("T")[0],fecha_fin:new Date().toISOString().split("T")[0],sucursal_id:null,tipo:null,atendida:null}),q=async()=>{A.value=!0;try{const a={};i.value.fecha_inicio&&(a.fecha_inicio=i.value.fecha_inicio),i.value.fecha_fin&&(a.fecha_fin=i.value.fecha_fin),i.value.sucursal_id&&(a.sucursal_id=i.value.sucursal_id),i.value.tipo&&(a.tipo=i.value.tipo),i.value.atendida!==null&&(a.atendida=i.value.atendida);const e=await j.get("/api/notificaciones-personal",{params:a});P.value=e.data.notificaciones}catch(a){console.error("Error al cargar notificaciones:",a),S.fire({icon:"error",title:"Error",text:"No se pudieron cargar las notificaciones",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}finally{A.value=!1}},le=async a=>{try{await j.post(`/api/notificaciones-personal/${a.id}/atender`),a.atendida=!0,S.fire({icon:"success",title:"Atendida",toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3})}catch{S.fire({icon:"error",title:"Error",text:"No se pudo marcar como atendida",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}},ie=a=>({faltante:"bg-red-100 text-red-800",excedente:"bg-yellow-100 text-yellow-800",horneado:"bg-orange-100 text-orange-800"})[a]||"bg-gray-100 text-gray-800",G=a=>new Intl.NumberFormat("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2}).format(a),de=a=>({produccion:"bg-orange-100 text-orange-800",venta:"bg-green-100 text-green-800",asistencia:"bg-purple-100 text-purple-800",inventario:"bg-blue-100 text-blue-800",gasto:"bg-red-100 text-red-800",corte_caja:"bg-gray-100 text-gray-800"})[a]||"bg-gray-100 text-gray-800",ue=(a,e)=>a==="venta"?e==="manual"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800":a==="asistencia"?e==="entrada"?"bg-green-100 text-green-800":"bg-red-100 text-red-800":a==="produccion"&&{pendiente:"bg-yellow-100 text-yellow-800",horneando:"bg-orange-100 text-orange-800",en_espera:"bg-blue-100 text-blue-800",vendido:"bg-green-100 text-green-800"}[e]||"bg-gray-100 text-gray-800",M=d(((Y=x.evaluacion)==null?void 0:Y.ranking)||[]),k=d(((J=x.evaluacion)==null?void 0:J.mejores)||{}),B=d(((K=x.evaluacion)==null?void 0:K.estadisticas)||{}),D=d(!1),H=d(!1),l=d(null),b=d({fecha_inicio:(()=>{const a=new Date;return new Date(a.getFullYear(),a.getMonth(),1).toISOString().split("T")[0]})(),fecha_fin:new Date().toISOString().split("T")[0],sucursal_id:null}),ce=()=>{var a;m.value="evaluacion",(a=M.value)!=null&&a.length||Q()},Q=async()=>{D.value=!0;try{const a=await j.post("/actividad-personal/evaluacion",b.value);M.value=a.data.ranking||[],k.value=a.data.mejores||{},B.value=a.data.estadisticas||{}}catch(a){console.error("Error al cargar evaluacion:",a),S.fire({icon:"error",title:"Error",text:"No se pudo cargar la evaluacion",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}finally{D.value=!1}},xe=async a=>{try{const e={fecha_inicio:b.value.fecha_inicio,fecha_fin:b.value.fecha_fin},f=await j.get(`/actividad-personal/evaluacion/detalle/${a}`,{params:e});l.value=f.data,H.value=!0}catch(e){console.error("Error al cargar detalle:",e),S.fire({icon:"error",title:"Error",text:"No se pudo cargar el detalle del empleado",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}},X=()=>{H.value=!1,l.value=null},pe=()=>{const a=new URLSearchParams(b.value);window.open(`/actividad-personal/evaluacion/exportar?${a.toString()}`,"_blank")},be=a=>({check_in:"Check-in",venta:"Venta",horneado:"Horneado",notificacion_atendida:"Notificacion Atendida",notificacion_no_atendida:"Notificacion No Atendida",sobrante:"Sobrante",corte_caja:"Corte de Caja"})[a]||a;return(a,e)=>{var f,y,W,Z,tt,et,ot,st,at,rt,nt,lt,it,dt,ut,ct,xt,pt,bt,gt,vt,mt,ft,yt,_t,ht,wt,kt,Ct,St,Nt,Vt,jt,Tt,Et,Ft,At,Mt,Dt,$t,Ut,Pt,Bt,Ht,It,Lt,Ot,zt,Rt,qt,Gt,Qt,Xt,Yt,Jt,Kt,Wt,Zt;return r(),n("div",we,[e[64]||(e[64]=t("h1",{class:"text-3xl font-semibold mb-6 text-center"},"Actividad del Personal",-1)),re.value?(r(),n("div",ke,[t("button",{onClick:e[0]||(e[0]=o=>m.value="actividades"),class:c([m.value==="actividades"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700","px-6 py-3 text-sm font-medium border-b-2 transition-colors"])}," Actividades ",2),t("button",{onClick:ne,class:c([m.value==="notificaciones"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700","px-6 py-3 text-sm font-medium border-b-2 transition-colors"])}," Notificaciones de Turno ",2),t("button",{onClick:ce,class:c([m.value==="evaluacion"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700","px-6 py-3 text-sm font-medium border-b-2 transition-colors"])}," Evaluacion ",2)])):g("",!0),u(t("div",null,[t("div",Ce,[t("div",Se,[t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha Inicio",-1)),u(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=o=>i.value.fecha_inicio=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},null,512),[[N,i.value.fecha_inicio]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha Fin",-1)),u(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=o=>i.value.fecha_fin=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},null,512),[[N,i.value.fecha_fin]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Sucursal",-1)),u(t("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>i.value.sucursal_id=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},[e[18]||(e[18]=t("option",{value:null},"Todas",-1)),(r(!0),n(_,null,h(T.value,o=>(r(),n("option",{key:o.id,value:o.id},s(o.nombre),9,Ne))),128))],512),[[C,i.value.sucursal_id]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tipo",-1)),u(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>i.value.tipo=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},e[20]||(e[20]=[t("option",{value:null},"Todos",-1),t("option",{value:"faltante"},"Faltante",-1),t("option",{value:"excedente"},"Excedente",-1),t("option",{value:"horneado"},"Horneado",-1)]),512),[[C,i.value.tipo]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Estado",-1)),u(t("select",{"onUpdate:modelValue":e[5]||(e[5]=o=>i.value.atendida=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},e[22]||(e[22]=[t("option",{value:null},"Todos",-1),t("option",{value:"0"},"Sin atender",-1),t("option",{value:"1"},"Atendidas",-1)]),512),[[C,i.value.atendida]])])]),t("div",Ve,[t("button",{onClick:q,disabled:A.value,class:"bg-orange-500 text-white px-6 py-2 rounded-md hover:bg-orange-600 transition-colors disabled:opacity-50"},[A.value?(r(),n("span",Te,"Cargando...")):(r(),n("span",Ee,"Filtrar"))],8,je)])]),t("div",Fe,[t("table",Ae,[e[25]||(e[25]=t("thead",{class:"bg-gray-100"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Fecha/Hora"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Trabajador"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Sucursal"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Tipo"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"DescripciÃ³n"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Atendida")])],-1)),t("tbody",null,[(r(!0),n(_,null,h(P.value,o=>(r(),n("tr",{key:o.id,class:"hover:bg-gray-50 transition-colors"},[t("td",Me,[t("div",De,s(o.fecha),1),t("div",$e,s(o.hora),1)]),t("td",Ue,s(o.trabajador),1),t("td",Pe,s(o.sucursal),1),t("td",Be,[t("span",{class:c([ie(o.tipo),"px-2 py-1 text-xs font-medium rounded-full"])},s(o.tipo),3)]),t("td",He,s(o.descripcion),1),t("td",Ie,[o.atendida?(r(),n("span",Le," Atendida ")):(r(),n("button",{key:1,onClick:$=>le(o),class:"px-3 py-1 text-xs font-medium bg-orange-500 text-white rounded-full hover:bg-orange-600 transition-colors"}," Atender ",8,Oe))])]))),128)),P.value.length===0?(r(),n("tr",ze,e[24]||(e[24]=[t("td",{colspan:"6",class:"px-4 py-8 text-center text-gray-500"}," No se encontraron notificaciones para los filtros seleccionados ",-1)]))):g("",!0)])])])],512),[[L,m.value==="notificaciones"]]),u(t("div",null,[t("div",Re,[t("div",qe,[t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha Inicio",-1)),u(t("input",{type:"date","onUpdate:modelValue":e[6]||(e[6]=o=>p.value.fecha_inicio=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},null,512),[[N,p.value.fecha_inicio]])]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha Fin",-1)),u(t("input",{type:"date","onUpdate:modelValue":e[7]||(e[7]=o=>p.value.fecha_fin=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},null,512),[[N,p.value.fecha_fin]])]),t("div",null,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Sucursal",-1)),u(t("select",{"onUpdate:modelValue":e[8]||(e[8]=o=>p.value.sucursal_id=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},[e[28]||(e[28]=t("option",{value:null},"Todas las sucursales",-1)),(r(!0),n(_,null,h(T.value,o=>(r(),n("option",{key:o.id,value:o.id},s(o.nombre),9,Ge))),128))],512),[[C,p.value.sucursal_id]])]),t("div",null,[e[31]||(e[31]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Usuario",-1)),u(t("select",{"onUpdate:modelValue":e[9]||(e[9]=o=>p.value.usuario_id=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},[e[30]||(e[30]=t("option",{value:null},"Todos los usuarios",-1)),(r(!0),n(_,null,h(z.value,o=>(r(),n("option",{key:o.id,value:o.id},s(o.nombre_completo),9,Qe))),128))],512),[[C,p.value.usuario_id]])]),t("div",null,[e[33]||(e[33]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tipo",-1)),u(t("select",{"onUpdate:modelValue":e[10]||(e[10]=o=>p.value.tipo_actividad=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},e[32]||(e[32]=[ve('<option>Todos los tipos</option><option value="produccion">Produccion</option><option value="venta">Ventas</option><option value="asistencia">Asistencia</option><option value="inventario">Inventario</option><option value="gasto">Gastos</option><option value="corte_caja">Corte de Caja</option>',7)]),512),[[C,p.value.tipo_actividad]])])]),t("div",Xe,[t("button",{onClick:ae,disabled:E.value,class:"bg-orange-500 text-white px-6 py-2 rounded-md hover:bg-orange-600 transition-colors duration-200 disabled:opacity-50"},[E.value?(r(),n("span",Je,"Cargando...")):(r(),n("span",Ke,"Filtrar"))],8,Ye)])]),t("div",We,[t("div",Ze,[e[34]||(e[34]=t("div",{class:"text-sm text-blue-600 font-medium"},"Total Actividades",-1)),t("div",to,s(w.value.total_actividades),1)]),t("div",eo,[e[35]||(e[35]=t("div",{class:"text-sm text-yellow-600 font-medium"},"Ventas Manuales",-1)),t("div",oo,s(((y=(f=w.value.ventas)==null?void 0:f.manuales)==null?void 0:y.cantidad)||0),1),t("div",so,"$"+s(G(((Z=(W=w.value.ventas)==null?void 0:W.manuales)==null?void 0:Z.total)||0)),1)]),t("div",ao,[e[36]||(e[36]=t("div",{class:"text-sm text-green-600 font-medium"},"Ventas Sistema (POS)",-1)),t("div",ro,s(((et=(tt=w.value.ventas)==null?void 0:tt.sistema)==null?void 0:et.cantidad)||0),1),t("div",no,"$"+s(G(((st=(ot=w.value.ventas)==null?void 0:ot.sistema)==null?void 0:st.total)||0)),1)]),t("div",lo,[e[37]||(e[37]=t("div",{class:"text-sm text-purple-600 font-medium"},"Asistencias",-1)),t("div",io,s(((at=w.value.por_tipo)==null?void 0:at.asistencia)||0),1)])]),t("div",uo,[t("table",co,[e[39]||(e[39]=t("thead",{class:"bg-gray-100"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Fecha/Hora"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Usuario"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Sucursal"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Tipo"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Subtipo"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Detalles")])],-1)),t("tbody",null,[(r(!0),n(_,null,h(R.value,o=>{var $,te;return r(),n("tr",{key:o.id,class:"hover:bg-gray-50 transition-colors"},[t("td",xo,[t("div",po,s(o.fecha),1),t("div",bo,s(o.hora),1)]),t("td",go,s(o.usuario),1),t("td",vo,s(o.sucursal),1),t("td",mo,[t("span",{class:c([de(o.tipo),"px-2 py-1 text-xs font-medium rounded-full"])},s(o.tipo_label),3)]),t("td",fo,[t("span",{class:c([ue(o.tipo,o.subtipo),"px-2 py-1 text-xs font-medium rounded-full"])},s(o.subtipo_label),3)]),t("td",yo,[o.tipo==="venta"&&((te=($=o.extra)==null?void 0:$.productos)!=null&&te.length)?(r(),n("span",{key:0,title:o.extra.productos.map(U=>`${U.nombre} x${U.cantidad} = $${(U.cantidad*U.precio_unitario).toFixed(2)}`).join(`
`),class:"cursor-help underline decoration-dotted"},s(o.detalles),9,_o)):(r(),n("span",ho,s(o.detalles),1))])])}),128)),V.value.length===0?(r(),n("tr",wo,e[38]||(e[38]=[t("td",{colspan:"6",class:"px-4 py-8 text-center text-gray-500"}," No se encontraron actividades para los filtros seleccionados ",-1)]))):g("",!0)])])]),F.value>1?(r(),n("div",ko,[t("button",{onClick:e[11]||(e[11]=o=>v.value=Math.max(1,v.value-1)),disabled:v.value===1,class:"px-3 py-1 border rounded-md disabled:opacity-50 hover:bg-gray-100"}," Anterior ",8,Co),t("span",So," Pagina "+s(v.value)+" de "+s(F.value),1),t("button",{onClick:e[12]||(e[12]=o=>v.value=Math.min(F.value,v.value+1)),disabled:v.value===F.value,class:"px-3 py-1 border rounded-md disabled:opacity-50 hover:bg-gray-100"}," Siguiente ",8,No)])):g("",!0),t("div",Vo," Mostrando "+s(R.value.length)+" de "+s(V.value.length)+" actividades ",1)],512),[[L,m.value==="actividades"]]),u(t("div",null,[t("div",jo,[t("div",To,[t("div",null,[e[40]||(e[40]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha Inicio",-1)),u(t("input",{type:"date","onUpdate:modelValue":e[13]||(e[13]=o=>b.value.fecha_inicio=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},null,512),[[N,b.value.fecha_inicio]])]),t("div",null,[e[41]||(e[41]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha Fin",-1)),u(t("input",{type:"date","onUpdate:modelValue":e[14]||(e[14]=o=>b.value.fecha_fin=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},null,512),[[N,b.value.fecha_fin]])]),t("div",null,[e[43]||(e[43]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Sucursal",-1)),u(t("select",{"onUpdate:modelValue":e[15]||(e[15]=o=>b.value.sucursal_id=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},[e[42]||(e[42]=t("option",{value:null},"Todas",-1)),(r(!0),n(_,null,h(T.value,o=>(r(),n("option",{key:o.id,value:o.id},s(o.nombre),9,Eo))),128))],512),[[C,b.value.sucursal_id]])]),t("div",Fo,[t("button",{onClick:Q,disabled:D.value,class:"flex-1 bg-orange-500 text-white px-4 py-2 rounded-md hover:bg-orange-600 transition-colors disabled:opacity-50"},[D.value?(r(),n("span",Mo,"Cargando...")):(r(),n("span",Do,"Filtrar"))],8,Ao),t("button",{onClick:pe,class:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors"}," CSV ")])])]),t("div",$o,[t("div",Uo,[e[44]||(e[44]=t("div",{class:"text-sm text-yellow-600 font-medium"},"Mejor Empleado",-1)),t("div",Po,s(((nt=(rt=k.value)==null?void 0:rt.mejor_general)==null?void 0:nt.nombre)||"-"),1),t("div",Bo,s(((it=(lt=k.value)==null?void 0:lt.mejor_general)==null?void 0:it.total_puntos)||0)+" puntos",1)]),t("div",Ho,[e[45]||(e[45]=t("div",{class:"text-sm text-blue-600 font-medium"},"Mas Ventas",-1)),t("div",Io,s(((ut=(dt=k.value)==null?void 0:dt.mas_ventas)==null?void 0:ut.nombre)||"-"),1),t("div",Lo,s(((xt=(ct=k.value)==null?void 0:ct.mas_ventas)==null?void 0:xt.total_ventas)||0)+" ventas",1)]),t("div",Oo,[e[46]||(e[46]=t("div",{class:"text-sm text-orange-600 font-medium"},"Mas Horneados",-1)),t("div",zo,s(((bt=(pt=k.value)==null?void 0:pt.mas_horneados)==null?void 0:bt.nombre)||"-"),1),t("div",Ro,s(((vt=(gt=k.value)==null?void 0:gt.mas_horneados)==null?void 0:vt.total_horneados)||0)+" lotes",1)]),t("div",qo,[e[47]||(e[47]=t("div",{class:"text-sm text-purple-600 font-medium"},"Promedio Horas",-1)),t("div",Go,s(((mt=B.value)==null?void 0:mt.promedio_horas_trabajadas)||0)+"h",1),t("div",Qo,s(((ft=B.value)==null?void 0:ft.total_empleados)||0)+" empleados",1)])]),t("div",Xo,[t("table",Yo,[e[49]||(e[49]=t("thead",{class:"bg-gray-100"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"#"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Empleado"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Sucursal"),t("th",{class:"px-4 py-3 text-center text-sm font-semibold text-gray-700 border-b"},"Puntos"),t("th",{class:"px-4 py-3 text-center text-sm font-semibold text-gray-700 border-b"},"Ventas"),t("th",{class:"px-4 py-3 text-center text-sm font-semibold text-gray-700 border-b"},"Horneados"),t("th",{class:"px-4 py-3 text-center text-sm font-semibold text-gray-700 border-b"},"Notif."),t("th",{class:"px-4 py-3 text-center text-sm font-semibold text-gray-700 border-b"},"Horas"),t("th",{class:"px-4 py-3 text-center text-sm font-semibold text-gray-700 border-b"},"Acciones")])],-1)),t("tbody",null,[(r(!0),n(_,null,h(M.value,o=>(r(),n("tr",{key:o.user_id,class:c([{"bg-yellow-50":o.posicion===1,"bg-gray-50":o.posicion===2,"bg-orange-50":o.posicion===3},"hover:bg-gray-100 transition-colors"])},[t("td",Jo,[t("span",{class:c({"text-yellow-600 font-bold text-lg":o.posicion===1,"text-gray-500 font-semibold":o.posicion===2,"text-orange-600 font-semibold":o.posicion===3,"text-gray-700":o.posicion>3}),innerHTML:o.posicion===1?"ðŸ†":o.posicion===2?"ðŸ¥ˆ":o.posicion===3?"ðŸ¥‰":o.posicion},null,10,Ko)]),t("td",Wo,[t("div",Zo,s(o.nombre),1),t("div",ts,s(o.email),1)]),t("td",es,s(o.sucursal),1),t("td",os,[t("span",{class:c(["px-2 py-1 text-sm font-semibold rounded-full",o.total_puntos>=0?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},s(o.total_puntos),3)]),t("td",ss,s(o.total_ventas),1),t("td",as,s(o.total_horneados),1),t("td",rs,s(o.notificaciones_atendidas),1),t("td",ns,s(o.horas_trabajadas)+"h",1),t("td",ls,[t("button",{onClick:$=>xe(o.user_id),class:"text-orange-600 hover:text-orange-800 text-sm font-medium"}," Ver detalle ",8,is)])],2))),128)),(yt=M.value)!=null&&yt.length?g("",!0):(r(),n("tr",ds,e[48]||(e[48]=[t("td",{colspan:"9",class:"px-4 py-8 text-center text-gray-500"}," No hay datos para mostrar en el rango de fechas seleccionado. ",-1)])))])])]),H.value?(r(),n("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:me(X,["self"])},[t("div",us,[t("div",cs,[t("h3",xs," Detalle de "+s((ht=(_t=l.value)==null?void 0:_t.empleado)==null?void 0:ht.nombre),1),t("button",{onClick:X,class:"text-gray-400 hover:text-gray-600"},e[50]||(e[50]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),l.value?(r(),n("div",ps,[t("div",bs,[t("p",gs,s((wt=l.value.empleado)==null?void 0:wt.email),1),t("p",vs,"Sucursal: "+s((kt=l.value.empleado)==null?void 0:kt.sucursal),1),((Ct=l.value.datos_ranking)==null?void 0:Ct.total_puntos)===0?(r(),n("div",ms,e[51]||(e[51]=[t("p",{class:"text-xs text-yellow-700"},[t("strong",null,"Sin datos:"),ee(" Este empleado no tiene registros de actividad en el perÃ­odo seleccionado. ")],-1)]))):(St=l.value.metricas)!=null&&St.es_tiempo_real?(r(),n("div",fs,e[52]||(e[52]=[t("p",{class:"text-xs text-blue-700"},[t("strong",null,"Nota:"),ee(" Los datos se calculan en tiempo real basados en ventas, check-ins, horneados y notificaciones registradas en el perÃ­odo seleccionado. ")],-1)]))):g("",!0)]),t("div",{class:c(["grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",{"opacity-50":((Nt=l.value.datos_ranking)==null?void 0:Nt.total_puntos)===0}])},[t("div",ys,[t("p",{class:c([((Vt=l.value.datos_ranking)==null?void 0:Vt.total_puntos)===0?"text-gray-400":"text-orange-600","text-2xl font-bold"])},s(((jt=l.value.datos_ranking)==null?void 0:jt.total_puntos)||((Tt=l.value.metricas)==null?void 0:Tt.total_puntos)||0),3),e[53]||(e[53]=t("p",{class:"text-xs text-gray-500"},"Puntos Totales",-1))]),t("div",_s,[t("p",{class:c([((Et=l.value.datos_ranking)==null?void 0:Et.total_puntos)===0?"text-gray-400":"text-blue-600","text-2xl font-bold"])},s(((Ft=l.value.datos_ranking)==null?void 0:Ft.total_ventas)||((Mt=(At=l.value.metricas)==null?void 0:At.resumen)==null?void 0:Mt.ventas)||0),3),e[54]||(e[54]=t("p",{class:"text-xs text-gray-500"},"Ventas",-1))]),t("div",hs,[t("p",{class:c([((Dt=l.value.datos_ranking)==null?void 0:Dt.total_puntos)===0?"text-gray-400":"text-orange-600","text-2xl font-bold"])},s((($t=l.value.datos_ranking)==null?void 0:$t.total_horneados)||((Pt=(Ut=l.value.metricas)==null?void 0:Ut.resumen)==null?void 0:Pt.horneados)||0),3),e[55]||(e[55]=t("p",{class:"text-xs text-gray-500"},"Horneados",-1))]),t("div",ws,[t("p",{class:c([((Bt=l.value.datos_ranking)==null?void 0:Bt.total_puntos)===0?"text-gray-400":"text-purple-600","text-2xl font-bold"])},s(((Ht=l.value.datos_ranking)==null?void 0:Ht.horas_trabajadas)||((It=l.value.metricas)==null?void 0:It.horas_trabajadas)||0)+"h",3),e[56]||(e[56]=t("p",{class:"text-xs text-gray-500"},"Horas",-1))])],2),t("div",null,[e[63]||(e[63]=t("h4",{class:"font-semibold text-gray-900 mb-3"},"Historial de Puntos",-1)),t("div",ks,[((Lt=l.value.datos_ranking)==null?void 0:Lt.total_puntos)===0?(r(),n("div",Cs,e[57]||(e[57]=[t("p",{class:"text-sm text-yellow-700"}," No hay registros de actividad en el perÃ­odo seleccionado ",-1)]))):(Ot=l.value.metricas)!=null&&Ot.es_tiempo_real?(r(),n("div",Ss,[e[62]||(e[62]=t("p",{class:"text-sm text-blue-700 mb-3"}," Los puntos se calculan en tiempo real basados en: ",-1)),t("div",Ns,[t("div",Vs,[e[58]||(e[58]=t("p",{class:"font-semibold text-blue-900"},"Check-ins",-1)),t("p",js,s(((zt=l.value.datos_ranking)==null?void 0:zt.total_check_ins)||0)+" Ã— 5 = "+s((((Rt=l.value.datos_ranking)==null?void 0:Rt.total_check_ins)||0)*5)+"pts",1)]),t("div",Ts,[e[59]||(e[59]=t("p",{class:"font-semibold text-blue-900"},"Ventas",-1)),t("p",Es,s(((qt=l.value.datos_ranking)==null?void 0:qt.total_ventas)||0)+" Ã— 2 = "+s((((Gt=l.value.datos_ranking)==null?void 0:Gt.total_ventas)||0)*2)+"pts",1)]),t("div",Fs,[e[60]||(e[60]=t("p",{class:"font-semibold text-blue-900"},"Horneados",-1)),t("p",As,s(((Qt=l.value.datos_ranking)==null?void 0:Qt.total_horneados)||0)+" Ã— 3 = "+s((((Xt=l.value.datos_ranking)==null?void 0:Xt.total_horneados)||0)*3)+"pts",1)]),t("div",Ms,[e[61]||(e[61]=t("p",{class:"font-semibold text-blue-900"},"Notif. Atendidas",-1)),t("p",Ds,s(((Yt=l.value.datos_ranking)==null?void 0:Yt.notificaciones_atendidas)||0)+" Ã— 10 = "+s((((Jt=l.value.datos_ranking)==null?void 0:Jt.notificaciones_atendidas)||0)*10)+"pts",1)])])])):(r(),n("div",$s,[(r(!0),n(_,null,h((Kt=l.value.metricas)==null?void 0:Kt.historial,o=>(r(),n("div",{key:o.id,class:"flex justify-between items-center py-2 border-b border-gray-100"},[t("div",null,[t("p",Us,s(be(o.concepto)),1),t("p",Ps,s(o.descripcion||"-"),1),t("p",Bs,s(new Date(o.created_at).toLocaleString()),1)]),t("span",{class:c(["px-2 py-1 text-sm font-semibold rounded-full",o.puntos>=0?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},s(o.puntos>=0?"+":"")+s(o.puntos),3)]))),128)),(Zt=(Wt=l.value.metricas)==null?void 0:Wt.historial)!=null&&Zt.length?g("",!0):(r(),n("p",Hs," Sin historial de puntos "))]))])])])):g("",!0)])])):g("",!0)],512),[[L,m.value==="evaluacion"]])])}}},Ls={class:"py-6"},Os={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 p-2 md:p-8"},zs={class:"bg-white overflow-hidden shadow-xl rounded-xl"},Xs={__name:"index",setup(se){const{props:x}=oe();return(z,T)=>fe(x).user.roles[0]!=="trabajador"?(r(),ye(ge,{key:0,title:"Actividad Personal"},{default:_e(()=>[t("div",Ls,[t("div",Os,[t("div",zs,[he(Is)])])])]),_:1})):g("",!0)}};export{Xs as default};
