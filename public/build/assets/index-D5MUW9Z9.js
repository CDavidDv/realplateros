import{o as n,e as u,a as e,t as a,n as c,F as S,h as D,g as d,f as C,Q as F,d as g,k as P,j as _,v as U,l as L,b as w,z as O,c as Q,w as R}from"./app-CtN4jI6a.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as T,_ as G}from"./AppLayout-95KzA-8h.js";const J={class:"p-6 text-left border shadow-lg rounded-xl bg-white"},K={key:0},W={class:"overflow-y-auto scrollbar-thin divide-y divide-gray-200",style:{"max-height":"25rem"}},X={class:"w-full h-full"},Y={class:"w-1/4 my-auto h-full flex flex-col gap-2 items-center justify-center"},Z=["onClick"],ee=["onClick"],te={__name:"TicketCard",props:{title:{type:String,required:!0},tickets:{type:Array,required:!0},textColor:{type:String,default:"gray-800"},tipo:{type:String,default:"asignar"},emptyMessage:{type:String,default:""}},emits:["view-ticket-details","cancel-ticket"],setup(o,{emit:m}){const v=m,p=b=>{v("view-ticket-details",b)},y=b=>{v("cancel-ticket",b)};return(b,r)=>(n(),u("div",J,[e("h2",{class:c(["text-xl font-semibold mb-4",{"text-yellow-500":o.tipo==="asignar","text-green-500":o.tipo==="cerrar","text-red-500":o.tipo==="cancelar"}])},a(o.title),3),o.tickets.length?(n(),u("div",K,[e("ul",W,[(n(!0),u(S,null,D(o.tickets,s=>{var x,f;return n(),u("li",{key:s.id,class:c(["p-4 flex justify-between items-start bg-gradient-to-br rounded-lg mb-2",{"from-yellow-50 to-yellow-100":o.tipo==="asignar","from-green-50 to-green-100":o.tipo==="cerrar","from-red-50 to-red-100":o.tipo==="cancelar"}])},[e("div",X,[e("p",{class:c(`text-sm text-${o.textColor}`)},[r[0]||(r[0]=e("strong",null,"ID:",-1)),d(" "+a(s.id),1)],2),e("p",{class:c(`text-sm text-${o.textColor}`)},[r[1]||(r[1]=e("strong",null,"Empleado:",-1)),d(" "+a(((x=s==null?void 0:s.usuario)==null?void 0:x.name)||"No asignado"),1)],2),e("p",{class:c(`text-sm text-${o.textColor}`)},[r[2]||(r[2]=e("strong",null,"Sucursal destino:",-1)),d(" "+a(((f=s==null?void 0:s.sucursal)==null?void 0:f.nombre)||"Sin destino"),1)],2),e("p",{class:c(`text-sm text-${o.textColor}`)},[r[3]||(r[3]=e("strong",null,"Hora salida:",-1)),d(" "+a(s.hora_salida||"N/A"),1)],2),s.hora_llegada?(n(),u("p",{key:0,class:c(`text-sm text-${o.textColor}`)},[r[4]||(r[4]=e("strong",null,"Hora llegada:",-1)),d(" "+a(s.hora_llegada),1)],2)):C("",!0)]),e("div",Y,[e("button",{class:"text-sm bg-blue-400 hover:bg-blue-500 text-gray-50 py-1 px-2 rounded-xl",onClick:k=>p(s)}," Ver detalles ",8,Z),o.tipo==="asignar"?(n(),u("button",{key:0,class:"text-sm bg-red-400 hover:bg-red-500 text-gray-50 py-1 px-2 rounded-xl ml-2",onClick:k=>y(s)}," Cancelar ",8,ee)):C("",!0)])],2)}),128))])])):(n(),u("p",{key:1,class:c(`text-${o.textColor}`)},a(o.emptyMessage||"No hay tickets en esta categorÃ­a"),3))]))}},$=q(te,[["__scopeId","data-v-a63a0680"]]),se={class:"p-10 min-h-screen bg-gray-50"},le={class:"flex flex-col md:flex-row justify-between items-center mb-8"},oe={class:"flex flex-col"},ae={class:"flex flex-col"},ne=["value"],re={class:"container mx-auto grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"},ie={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},de={class:"bg-white p-8 rounded-2xl shadow-2xl w-full max-w-screen-lg overflow-y-auto max-h-screen"},ue={class:"space-y-4"},ce={key:0},ge={class:"mt-6"},me={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mt-2"},xe={__name:"TicketsAsignados",setup(o){const{props:m}=F(),v=g(m.ticketsCerrados),p=g(m.ticketsAsignados),y=g(m.ticketsCancelados),b=g(m.sucursales),r=g(!1),s=g(null),x=g(""),f=g(""),k=i=>{s.value=i,r.value=!0},H=()=>{r.value=!1,s.value=null},I=i=>{O.post("/tickets/cancelar",{ticket:i.id},{preserveScroll:!0,onSuccess:t=>{p.value=t.props.ticketsAsignados,y.value=t.props.ticketsCancelados},onError:t=>{console.error("Error al cancelar el ticket:",t)}})},h=T.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:i=>{i.onmouseenter=T.stopTimer,i.onmouseleave=T.resumeTimer}}),z=()=>{if(!x.value||!f.value){h.fire({icon:"error",title:"Por favor, seleccione una fecha y una sucursal"});return}axios.post("/tickets/buscar",{fecha:x.value,sucursal:f.value}).then(i=>{p.value=i.data.ticketsAsignados,v.value=i.data.ticketsCerrados,y.value=i.data.ticketsCancelados,console.log(i.data),h.fire({icon:"success",title:"Tickets encontrados"})}).catch(i=>{console.error("Error al buscar tickets:",i),h.fire({icon:"error",title:"Error al buscar tickets"})})};return(i,t)=>{var A,E,N,V;return n(),u("div",se,[e("div",le,[t[7]||(t[7]=e("h1",{class:"text-2xl font-bold text-gray-800"},"Tarjetas Recientes",-1)),e("form",{onSubmit:P(z,["prevent"]),class:"flex flex-col md:flex-row gap-4 mt-4 md:mt-0"},[e("div",oe,[t[2]||(t[2]=e("label",{for:"fecha",class:"text-sm font-medium text-gray-700 mb-1"},"Buscar por fecha",-1)),_(e("input",{type:"date",id:"fecha","onUpdate:modelValue":t[0]||(t[0]=l=>x.value=l),required:"",class:"p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"},null,512),[[U,x.value]])]),e("div",ae,[t[5]||(t[5]=e("label",{for:"sucursal",class:"text-sm font-medium text-gray-700 mb-1"},"Buscar por sucursal",-1)),_(e("select",{id:"sucursal","onUpdate:modelValue":t[1]||(t[1]=l=>f.value=l),required:"",class:"py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"},[t[3]||(t[3]=e("option",{value:""},"Seleccione sucursal",-1)),t[4]||(t[4]=e("option",{value:"todas"},"Todas",-1)),(n(!0),u(S,null,D(b.value,l=>(n(),u("option",{key:l.id,value:l.id},a(l.nombre),9,ne))),128))],512),[[L,f.value]])]),t[6]||(t[6]=e("button",{type:"submit",class:"mt-6 md:mt-0 px-4 h-fit py-2 bg-orange-500 text-white font-semibold rounded-lg hover:bg-orange-600 transition"}," Buscar ",-1))],32)]),e("div",re,[w($,{title:"Entregas Asignados",tickets:p.value,tipo:"asignar",onViewTicketDetails:k,onCancelTicket:I},null,8,["tickets"]),w($,{title:"Entregas Completados",tickets:v.value,tipo:"cerrar",onViewTicketDetails:k},null,8,["tickets"]),w($,{title:"Entregas Cancelados",tickets:y.value,tipo:"cancelar",onViewTicketDetails:k},null,8,["tickets"])]),r.value?(n(),u("div",ie,[e("div",de,[t[18]||(t[18]=e("h3",{class:"text-2xl font-bold text-gray-800 mb-6 text-center border-b pb-4"}," Detalles del Ticket ",-1)),e("div",ue,[e("p",null,[t[8]||(t[8]=e("strong",{class:"font-semibold"},"ID:",-1)),d(" "+a(s.value.id),1)]),e("p",null,[t[9]||(t[9]=e("strong",{class:"font-semibold"},"Empleado:",-1)),d(" "+a(((E=(A=s.value)==null?void 0:A.usuario)==null?void 0:E.name)||"No asignado"),1)]),e("p",null,[t[10]||(t[10]=e("strong",{class:"font-semibold"},"Sucursal destino:",-1)),d(" "+a(((V=(N=s.value)==null?void 0:N.sucursal)==null?void 0:V.nombre)||"Sin destino"),1)]),e("p",null,[t[11]||(t[11]=e("strong",{class:"font-semibold"},"Hora salida:",-1)),d(" "+a(s.value.hora_salida||"N/A"),1)]),s.value.hora_llegada?(n(),u("p",ce,[t[12]||(t[12]=e("strong",{class:"font-semibold"},"Hora llegada:",-1)),d(" "+a(s.value.hora_llegada),1)])):C("",!0)]),e("div",ge,[t[17]||(t[17]=e("span",{class:"font-semibold text-lg text-gray-800"},"Productos:",-1)),e("ul",me,[(n(!0),u(S,null,D(s.value.ticket_productos_asignacion,l=>{var B,j,M;return n(),u("li",{key:l.id,class:"p-4 border rounded-lg shadow-sm hover:shadow-md transition"},[e("p",null,[t[13]||(t[13]=e("strong",null,"Nombre:",-1)),d(" "+a((B=l==null?void 0:l.producto)==null?void 0:B.nombre),1)]),e("p",null,[t[14]||(t[14]=e("strong",null,"Detalle:",-1)),d(" "+a((j=l==null?void 0:l.producto)==null?void 0:j.detalle),1)]),e("p",null,[t[15]||(t[15]=e("strong",null,"Tipo:",-1)),d(" "+a((M=l==null?void 0:l.producto)==null?void 0:M.tipo),1)]),e("p",null,[t[16]||(t[16]=e("strong",null,"Cantidad:",-1)),d(" "+a(l==null?void 0:l.cantidad),1)])])}),128))])]),e("div",{class:"flex justify-center mt-6"},[e("button",{class:"px-6 py-2 bg-red-500 text-white font-semibold text-sm rounded-lg hover:bg-red-600 transition",onClick:H}," Cerrar ")])])])):C("",!0)])}}},fe=q(xe,[["__scopeId","data-v-fc8b40cd"]]),ve={class:"py-6 px-2"},be={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},pe={class:"bg-white overflow-hidden shadow-xl rounded-lg py-2"},Ce={__name:"index",setup(o){return(m,v)=>(n(),Q(G,{title:"Tablero principal"},{default:R(()=>[e("div",ve,[e("div",be,[e("div",pe,[w(fe)])])])]),_:1}))}};export{Ce as default};
