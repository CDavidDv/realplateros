import{S as F,_ as H}from"./AppLayout-BNd_n1B1.js";import{Q,T as q,d,x as G,o as r,e as n,a as e,k as T,j as m,v as x,u as i,t as o,f as u,F as v,h as D,n as C,y as J,z as R,c as K,w as W,b as X}from"./app-DMv9JhpX.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"min-h-max h-[80vh] gap-5 m-auto md:flex-row flex flex-col items-center p-4 md:p-8 justify-center"},Z={class:"flex flex-col w-full"},ee={class:"w-full flex gap-5 flex-col md:flex-row items-start"},se={class:"md:w-4/12 h-fit w-full border p-10 rounded-xl shadow-xl"},te={class:"rounded-md shadow-sm -space-y-px"},oe={key:0,class:"mt-4 text-sm text-green-600"},ae={key:1,class:"mt-4 text-sm text-red-600"},re={key:0,class:"md:w-8/12 w-full h-fit"},ne={class:"flex md:space-x-4 flex-col md:flex-row"},le={class:"flex-1 p-2 md:p-0"},de={class:"flex-1 p-2 md:p-0"},ie={class:"overflow-x-auto"},ce={class:"min-w-full divide-y divide-gray-200"},ue={class:"bg-gray-50"},pe={class:"bg-white divide-y divide-gray-200"},me={class:"px-6 py-4 whitespace-nowrap"},xe={class:"px-6 py-4 whitespace-nowrap"},fe={class:"px-6 py-4 whitespace-nowrap"},he={class:"px-6 py-4 whitespace-nowrap"},ge={class:"px-6 py-4 whitespace-nowrap"},we={class:"px-6 py-4 whitespace-nowrap"},ve={key:0,class:"min-h-max w-full gap-5 m-auto md:flex-row flex flex-col items-center p-4 md:p-8 justify-center"},ye={class:"w-full"},_e={class:"flex flex-col items-center justify-center"},be={key:0,class:"mt-4 text-sm text-green-600"},ke={key:1,class:"mt-4 text-sm text-red-600"},Se={key:0,class:"mt-6"},De={class:"overflow-x-auto"},Ee={class:"min-w-full divide-y divide-gray-200"},Me={class:"bg-gray-50"},Fe={class:"bg-white divide-y divide-gray-200"},Te={class:"px-6 py-4 whitespace-nowrap"},Ue={class:"px-6 py-4 whitespace-nowrap"},Be={class:"px-6 py-4 whitespace-nowrap"},Ie={class:"px-6 py-4 whitespace-nowrap"},Ve={class:"px-6 py-4 whitespace-nowrap"},$e={class:"px-6 py-4 whitespace-nowrap"},qe={class:"px-6 py-4 whitespace-nowrap"},Ce={class:"px-6 py-4 whitespace-nowrap"},Re={class:"px-6 py-4 whitespace-nowrap"},Ne={__name:"Checador",setup(N){const{props:p}=Q(),l=q({email:"",password:"",sucursal_id:p.auth.user.sucursal_id}),f=d({email:"",searchDate:""}),z=d(["ID","Nombre","Estado","Entrada","Salida","Horas Trabajadas"]),A=d(["ID","Sucursal","Nombre","Apellido P.","Apellido M.","Estado","Entrada","Salida"]),y=d(""),_=d(""),E=d([]),L=()=>{J.post("/search-user-check-ins",f.value).then(a=>{E.value=a.data.checkIns,_.value="Resultados de la búsqueda obtenidos con éxito.",y.value="",j("success","Resultados de la búsqueda obtenidos con éxito.")}).catch(a=>{y.value=`Error al obtener los resultados de la búsqueda. ${a}`,_.value=""})},c=q({startDate:"",endDate:""}),M=d(p.checkIns),b=d(""),k=d("");G(()=>{p.filters&&(c.startDate=p.filters.startDate||"",c.endDate=p.filters.endDate||"")});const S=a=>a?new Date(a).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"}):"-",P=()=>{R.post("/checkInOut",{email:l.email,password:l.password,sucursal_id:l.sucursal_id},{preserveState:!0,preserveScroll:!0,onSuccess:a=>{b.value=a.props.flash.success,k.value="",l.reset("password"),l.reset("email"),M.value=a.props.checkIns},onError:a=>{k.value=Object.values(a)[0],b.value=""}})},O=()=>{R.post("/search-check-ins",c.data(),{preserveState:!0,preserveScroll:!0,only:["checkIns"],onSuccess:a=>{M.value=a.props.checkIns}})},j=(a,t)=>{F.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,customClass:"no-print",didOpen:s=>{s.addEventListener("mouseenter",F.stopTimer),s.addEventListener("mouseleave",F.resumeTimer)}}).fire({icon:a,title:t})};return(a,t)=>(r(),n(v,null,[e("div",Y,[e("div",Z,[e("div",ee,[e("div",se,[t[9]||(t[9]=e("div",null,[e("h2",{class:"mt-6 text-center text-3xl font-extrabold text-gray-900"}," Registro de Entrada/Salida ")],-1)),e("form",{class:"mt-8 space-y-6",onSubmit:T(P,["prevent"])},[e("div",te,[e("div",null,[t[6]||(t[6]=e("label",{for:"email",class:"sr-only"},"Matricula de Usuario",-1)),m(e("input",{id:"email",name:"email",type:"text",required:"",autocomplete:"username",class:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-orange-500 focus:border-orange-500 focus:z-10 sm:text-sm",placeholder:"Matricula de Usuario","onUpdate:modelValue":t[0]||(t[0]=s=>i(l).email=s)},null,512),[[x,i(l).email]])]),e("div",null,[t[7]||(t[7]=e("label",{for:"password",class:"sr-only"},"Contraseña",-1)),m(e("input",{id:"password",name:"password",type:"password",required:"",autocomplete:"current-password",class:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-orange-500 focus:border-orange-500 focus:z-10 sm:text-sm",placeholder:"Contraseña","onUpdate:modelValue":t[1]||(t[1]=s=>i(l).password=s)},null,512),[[x,i(l).password]])])]),t[8]||(t[8]=e("div",null,[e("button",{type:"submit",class:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500"}," Registrar ")],-1))],32),b.value?(r(),n("div",oe,o(b.value),1)):u("",!0),k.value?(r(),n("div",ae,o(k.value),1)):u("",!0)]),a.$page.props.user.roles[0].name!=="trabajador"?(r(),n("div",re,[e("form",{class:"mb-4 p-4 border rounded-xl shadow-md",onSubmit:T(O,["prevent"])},[e("div",ne,[e("div",le,[t[10]||(t[10]=e("label",{for:"startDate",class:"block text-sm font-medium text-gray-700"},"Fecha de Inicio",-1)),m(e("input",{id:"startDate",type:"date","onUpdate:modelValue":t[2]||(t[2]=s=>i(c).startDate=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm"},null,512),[[x,i(c).startDate]])]),e("div",de,[t[11]||(t[11]=e("label",{for:"endDate",class:"block text-sm font-medium text-gray-700"},"Fecha de Fin",-1)),m(e("input",{id:"endDate",type:"date","onUpdate:modelValue":t[3]||(t[3]=s=>i(c).endDate=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm"},null,512),[[x,i(c).endDate]])]),t[12]||(t[12]=e("div",{class:"flex-1 flex items-end p-2 md:p-0"},[e("button",{type:"submit",class:"w-full py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500"}," Buscar ")],-1))])],32),e("div",ie,[e("table",ce,[e("thead",ue,[e("tr",null,[(r(!0),n(v,null,D(z.value,s=>(r(),n("th",{scope:"col",key:s,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},o(s),1))),128))])]),e("tbody",pe,[(r(!0),n(v,null,D(M.value,s=>{var h,g,w;return r(),n("tr",{key:s.id},[e("td",me,o(s.user.email),1),e("td",xe,o(s.user.name),1),e("td",fe,[e("span",{class:C([(s.estado||"Ausente")==="Presente"?"bg-green-100 text-green-800":"bg-red-100 text-red-800","px-2 inline-flex text-xs leading-5 font-semibold rounded-full"])},o(s.estado),3)]),e("td",he,o(((h=s.check_in)==null?void 0:h.length)>0?S(s.check_in):"-"),1),e("td",ge,o(((g=s.check_out)==null?void 0:g.length)>0&&s.check_out?S(s.check_out):"-"),1),e("td",we,o(((w=s.check_out)==null?void 0:w.length)>0?(s.horas_trabajadas/60).toFixed(2):"-"),1)])}),128))])])])])):u("",!0)])])]),a.$page.props.auth.user.roles[0].name!="trabajador"?(r(),n("div",ve,[e("div",ye,[t[17]||(t[17]=e("h2",{class:"text-center text-2xl font-bold text-gray-900 mb-6"}," Buscar Registro de Usuario ",-1)),e("div",_e,[e("form",{class:"space-y-6 w-1/2",onSubmit:T(L,["prevent"])},[e("div",null,[t[13]||(t[13]=e("label",{for:"userEmail",class:"block text-sm font-medium text-gray-700"},"Matricula del Usuario",-1)),m(e("input",{id:"userEmail",type:"text","onUpdate:modelValue":t[4]||(t[4]=s=>f.value.email=s),required:"",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500",placeholder:"Matricula del usuario"},null,512),[[x,f.value.email]])]),e("div",null,[t[14]||(t[14]=e("label",{for:"searchDate",class:"block text-sm font-medium text-gray-700"},"Fecha",-1)),m(e("input",{id:"searchDate",type:"date","onUpdate:modelValue":t[5]||(t[5]=s=>f.value.searchDate=s),required:"",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500"},null,512),[[x,f.value.searchDate]])]),t[15]||(t[15]=e("div",null,[e("button",{type:"submit",class:"w-full py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500"}," Buscar ")],-1))],32),_.value?(r(),n("div",be,o(_.value),1)):u("",!0),y.value?(r(),n("div",ke,o(y.value),1)):u("",!0)]),E.value?(r(),n("div",Se,[t[16]||(t[16]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Resultados de la Búsqueda",-1)),e("div",De,[e("table",Ee,[e("thead",Me,[e("tr",null,[(r(!0),n(v,null,D(A.value,s=>(r(),n("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",key:s},o(s),1))),128))])]),e("tbody",Fe,[(r(!0),n(v,null,D(E.value,s=>{var h,g,w,U,B,I,V,$;return r(),n("tr",{key:s.id},[e("td",Te,o((h=s==null?void 0:s.user)==null?void 0:h.email),1),e("td",Ue,o((g=s==null?void 0:s.sucursal)==null?void 0:g.nombre),1),e("td",Be,o((w=s==null?void 0:s.user)==null?void 0:w.name),1),e("td",Ie,o((U=s==null?void 0:s.sucursal)==null?void 0:U.apellido_p),1),e("td",Ve,o((B=s==null?void 0:s.sucursal)==null?void 0:B.apellido_m),1),e("td",$e,[e("span",{class:C([((s==null?void 0:s.estado)||"Ausente")==="Presente"?"bg-green-100 text-green-800":"bg-red-100 text-red-800","px-2 inline-flex text-xs leading-5 font-semibold rounded-full"])},o(s==null?void 0:s.estado),3)]),e("td",qe,o(((I=s.check_in)==null?void 0:I.length)>0?S(s.check_in):"-"),1),e("td",Ce,o(((V=s.check_out)==null?void 0:V.length)>0&&s.check_out?S(s.check_out):"-"),1),e("td",Re,o((($=s.check_out)==null?void 0:$.length)>0?(s.horas_trabajadas/60).toFixed(2):"-"),1)])}),128))])])])])):u("",!0)])])):u("",!0)],64))}},ze={class:"py-6 px-2"},Ae={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 py-10"},Le={class:"bg-white overflow-hidden shadow-xl rounded-lg"},Pe={class:"overflow-hidden"},Qe={__name:"index",setup(N){return(p,l)=>(r(),K(H,{title:"Tablero principal"},{default:W(()=>[e("div",ze,[e("div",Ae,[e("div",Le,[e("div",Pe,[X(Ne)])])])])]),_:1}))}};export{Qe as default};
