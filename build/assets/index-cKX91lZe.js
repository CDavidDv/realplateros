import{S,_ as Qt}from"./AppLayout-mBxnksJT.js";import{Q as At,d as i,i as I,o as n,e as l,a as t,n as g,f as v,j as d,v as O,k as j,F as y,h as _,t as s,l as k,m as Xt,p as Yt,q as T,u as Jt,c as Kt,w as Wt,b as Zt}from"./app-D4kB8GLl.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const te={class:"relative px-6 py-8 bg-white shadow-lg sm:rounded-3xl sm:p-12"},ee={key:0,class:"flex border-b border-gray-200 mb-6"},oe={class:"mb-4 bg-gray-50 p-4 rounded-lg"},se={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},ae=["value"],ne={class:"mt-4 flex justify-end"},le=["disabled"],re={key:0},ie={key:1},de={class:"overflow-x-auto"},ue={class:"min-w-full bg-white border border-gray-200 rounded-lg"},ce={class:"px-4 py-3 border-b"},xe={class:"text-sm font-medium text-gray-900"},pe={class:"text-xs text-gray-500"},ge={class:"px-4 py-3 border-b text-sm text-gray-700"},be={class:"px-4 py-3 border-b text-sm text-gray-700"},me={class:"px-4 py-3 border-b"},ve={class:"px-4 py-3 border-b text-sm text-gray-700"},fe={class:"px-4 py-3 border-b"},ye={key:0,class:"px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800"},_e=["onClick"],he={key:0},we={class:"mb-6 bg-gray-50 p-4 rounded-lg"},ke={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},Ce=["value"],Se=["value"],je={class:"mt-4 flex justify-end"},Fe=["disabled"],Te={key:0},Ve={key:1},Ne={class:"mb-6 grid grid-cols-2 md:grid-cols-4 gap-4"},Ee={class:"bg-blue-50 p-4 rounded-lg border border-blue-200"},De={class:"text-2xl font-bold text-blue-800"},Me={class:"bg-yellow-50 p-4 rounded-lg border border-yellow-200"},Ae={class:"text-2xl font-bold text-yellow-800"},$e={class:"text-sm text-yellow-600"},Ue={class:"bg-green-50 p-4 rounded-lg border border-green-200"},Pe={class:"text-2xl font-bold text-green-800"},Be={class:"text-sm text-green-600"},He={class:"bg-purple-50 p-4 rounded-lg border border-purple-200"},Ie={class:"text-2xl font-bold text-purple-800"},Oe={class:"overflow-x-auto"},Le={class:"min-w-full bg-white border border-gray-200 rounded-lg"},ze={class:"px-4 py-3 border-b"},Re={class:"text-sm font-medium text-gray-900"},qe={class:"text-xs text-gray-500"},Ge={class:"px-4 py-3 border-b text-sm text-gray-700"},Qe={class:"px-4 py-3 border-b text-sm text-gray-700"},Xe={class:"px-4 py-3 border-b"},Ye={class:"px-4 py-3 border-b"},Je={class:"px-4 py-3 border-b text-sm text-gray-700"},Ke=["title"],We={key:1},Ze={key:0},to={key:0,class:"mt-4 flex justify-center items-center space-x-2"},eo=["disabled"],oo={class:"text-sm text-gray-600"},so=["disabled"],ao={class:"mt-2 text-center text-sm text-gray-500"},no={class:"mb-6 bg-gray-50 p-4 rounded-lg"},lo={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},ro=["value"],io={class:"flex items-end gap-2"},uo=["disabled"],co={key:0},xo={key:1},po={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},go={class:"bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-lg shadow p-4 text-white"},bo={class:"flex items-center justify-between"},mo={class:"text-lg font-bold truncate"},vo={class:"text-sm opacity-90"},fo={class:"bg-gradient-to-br from-blue-400 to-blue-600 rounded-lg shadow p-4 text-white"},yo={class:"flex items-center justify-between"},_o={class:"text-lg font-bold truncate"},ho={class:"text-sm opacity-90"},wo={class:"bg-gradient-to-br from-red-400 to-red-600 rounded-lg shadow p-4 text-white"},ko={class:"flex items-center justify-between"},Co={class:"text-lg font-bold truncate"},So={class:"text-sm opacity-90"},jo={class:"bg-gradient-to-br from-purple-400 to-purple-600 rounded-lg shadow p-4 text-white"},Fo={class:"flex items-center justify-between"},To={class:"text-lg font-bold"},Vo={class:"text-sm opacity-90"},No={class:"overflow-x-auto"},Eo={class:"min-w-full bg-white border border-gray-200 rounded-lg"},Do={class:"px-4 py-3 border-b"},Mo=["innerHTML"],Ao={class:"px-4 py-3 border-b"},$o={class:"text-sm font-medium text-gray-900"},Uo={class:"text-xs text-gray-500"},Po={class:"px-4 py-3 border-b text-sm text-gray-700"},Bo={class:"px-4 py-3 border-b text-center"},Ho={class:"px-4 py-3 border-b text-center text-sm text-gray-700"},Io={class:"px-4 py-3 border-b text-center text-sm text-gray-700"},Oo={class:"px-4 py-3 border-b text-center text-sm text-gray-700"},Lo={class:"px-4 py-3 border-b text-center text-sm text-gray-700"},zo={class:"px-4 py-3 border-b text-center"},Ro=["onClick"],qo={key:0},Go={class:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"},Qo={class:"px-6 py-4 border-b border-gray-200 flex justify-between items-center"},Xo={class:"text-lg font-semibold text-gray-900"},Yo={key:0,class:"p-6"},Jo={class:"mb-6"},Ko={class:"text-gray-600"},Wo={class:"text-gray-600"},Zo={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6"},ts={class:"bg-gray-50 rounded-lg p-3 text-center"},es={class:"text-2xl font-bold text-orange-600"},os={class:"bg-gray-50 rounded-lg p-3 text-center"},ss={class:"text-2xl font-bold text-blue-600"},as={class:"bg-gray-50 rounded-lg p-3 text-center"},ns={class:"text-2xl font-bold text-red-600"},ls={class:"bg-gray-50 rounded-lg p-3 text-center"},rs={class:"text-2xl font-bold text-purple-600"},is={class:"max-h-64 overflow-y-auto"},ds={class:"text-sm font-medium text-gray-900"},us={class:"text-xs text-gray-500"},cs={class:"text-xs text-gray-400"},xs={key:0,class:"text-gray-500 text-center py-4"},L=20,ps={__name:"ActividadPersonal",setup($t){var Y,J,K;const{props:u}=At(),z=i(u.usuarios||[]),V=i(u.sucursales||[]),F=i(u.actividades||[]),h=i(u.resumen||{}),p=i({fecha_inicio:u.fechaInicio||new Date().toISOString().split("T")[0],fecha_fin:u.fechaFin||new Date().toISOString().split("T")[0],sucursal_id:null,usuario_id:null,tipo_actividad:null}),N=i(!1),b=i(1),E=I(()=>Math.ceil(F.value.length/L)),R=I(()=>{const a=(b.value-1)*L,e=a+L;return F.value.slice(a,e)}),Ut=async()=>{N.value=!0,b.value=1;try{const a=await T.post("/actividad-personal/filtro",p.value);F.value=a.data.actividades,h.value=a.data.resumen}catch(a){console.error("Error al filtrar:",a),S.fire({icon:"error",title:"Error",text:"No se pudieron cargar las actividades",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}finally{N.value=!1}},m=i("actividades"),Pt=I(()=>{var C;const a=((C=u.auth)==null?void 0:C.user)||u.user;return((a==null?void 0:a.roles)||[]).some(f=>(typeof f=="string"?f:f==null?void 0:f.name)==="admin")}),Bt=()=>{m.value="notificaciones",q()},P=i([]),D=i(!1),r=i({fecha_inicio:new Date().toISOString().split("T")[0],fecha_fin:new Date().toISOString().split("T")[0],sucursal_id:null,tipo:null,atendida:null}),q=async()=>{D.value=!0;try{const a={};r.value.fecha_inicio&&(a.fecha_inicio=r.value.fecha_inicio),r.value.fecha_fin&&(a.fecha_fin=r.value.fecha_fin),r.value.sucursal_id&&(a.sucursal_id=r.value.sucursal_id),r.value.tipo&&(a.tipo=r.value.tipo),r.value.atendida!==null&&(a.atendida=r.value.atendida);const e=await T.get("/api/notificaciones-personal",{params:a});P.value=e.data.notificaciones}catch(a){console.error("Error al cargar notificaciones:",a),S.fire({icon:"error",title:"Error",text:"No se pudieron cargar las notificaciones",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}finally{D.value=!1}},Ht=async a=>{try{await T.post(`/api/notificaciones-personal/${a.id}/atender`),a.atendida=!0,S.fire({icon:"success",title:"Atendida",toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3})}catch{S.fire({icon:"error",title:"Error",text:"No se pudo marcar como atendida",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}},It=a=>({faltante:"bg-red-100 text-red-800",excedente:"bg-yellow-100 text-yellow-800",horneado:"bg-orange-100 text-orange-800"})[a]||"bg-gray-100 text-gray-800",M=i(((Y=u.evaluacion)==null?void 0:Y.ranking)||[]),w=i(((J=u.evaluacion)==null?void 0:J.mejores)||{}),B=i(((K=u.evaluacion)==null?void 0:K.estadisticas)||{}),A=i(!1),H=i(!1),x=i(null),c=i({fecha_inicio:(()=>{const a=new Date;return new Date(a.getFullYear(),a.getMonth(),1).toISOString().split("T")[0]})(),fecha_fin:new Date().toISOString().split("T")[0],sucursal_id:null}),Ot=()=>{m.value="evaluacion",M.value.length||G()},G=async()=>{A.value=!0;try{const a=await T.post("/actividad-personal/evaluacion",c.value);M.value=a.data.ranking||[],w.value=a.data.mejores||{},B.value=a.data.estadisticas||{}}catch(a){console.error("Error al cargar evaluacion:",a),S.fire({icon:"error",title:"Error",text:"No se pudo cargar la evaluacion",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}finally{A.value=!1}},Lt=async a=>{try{const e=await T.get(`/actividad-personal/evaluacion/detalle/${a}`,{params:{fecha_inicio:c.value.fecha_inicio,fecha_fin:c.value.fecha_fin}});e.data.success&&(x.value=e.data,H.value=!0)}catch(e){console.error("Error al obtener detalle:",e),S.fire({icon:"error",title:"Error",text:"No se pudo cargar el detalle del empleado",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}},Q=()=>{H.value=!1,x.value=null},zt=()=>{const a=new URLSearchParams({fecha_inicio:c.value.fecha_inicio,fecha_fin:c.value.fecha_fin});c.value.sucursal_id&&a.append("sucursal_id",c.value.sucursal_id),window.location.href=`/actividad-personal/evaluacion/exportar?${a.toString()}`},Rt=a=>({check_in:"Check-in",venta:"Ventas",horneado:"Horneados",notificacion_atendida:"Notif. Atendidas",notificacion_no_atendida:"Notif. No Atendidas",sobrante:"Sobrantes",corte_caja:"Corte Caja"})[a]||a,X=a=>new Intl.NumberFormat("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2}).format(a),qt=a=>({produccion:"bg-orange-100 text-orange-800",venta:"bg-green-100 text-green-800",asistencia:"bg-purple-100 text-purple-800",inventario:"bg-blue-100 text-blue-800",gasto:"bg-red-100 text-red-800",corte_caja:"bg-gray-100 text-gray-800"})[a]||"bg-gray-100 text-gray-800",Gt=(a,e)=>a==="venta"?e==="manual"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800":a==="asistencia"?e==="entrada"?"bg-green-100 text-green-800":"bg-red-100 text-red-800":a==="produccion"&&{pendiente:"bg-yellow-100 text-yellow-800",horneando:"bg-orange-100 text-orange-800",en_espera:"bg-blue-100 text-blue-800",vendido:"bg-green-100 text-green-800"}[e]||"bg-gray-100 text-gray-800";return(a,e)=>{var C,f,W,Z,tt,et,ot,st,at,nt,lt,rt,it,dt,ut,ct,xt,pt,gt,bt,mt,vt,ft,yt,_t,ht,wt,kt,Ct,St,jt,Ft,Tt,Vt,Nt,Et,Dt;return n(),l("div",te,[e[60]||(e[60]=t("h1",{class:"text-3xl font-semibold mb-6 text-center"},"Actividad del Personal",-1)),Pt.value?(n(),l("div",ee,[t("button",{onClick:e[0]||(e[0]=o=>m.value="actividades"),class:g([m.value==="actividades"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700","px-6 py-3 text-sm font-medium border-b-2 transition-colors"])}," Actividades ",2),t("button",{onClick:Bt,class:g([m.value==="notificaciones"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700","px-6 py-3 text-sm font-medium border-b-2 transition-colors"])}," Notificaciones de Turno ",2),t("button",{onClick:Ot,class:g([m.value==="evaluacion"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700","px-6 py-3 text-sm font-medium border-b-2 transition-colors"])}," Evaluacion ",2)])):v("",!0),d(t("div",null,[t("div",oe,[t("div",se,[t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha Inicio",-1)),d(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=o=>r.value.fecha_inicio=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},null,512),[[j,r.value.fecha_inicio]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha Fin",-1)),d(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=o=>r.value.fecha_fin=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},null,512),[[j,r.value.fecha_fin]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Sucursal",-1)),d(t("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>r.value.sucursal_id=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},[e[18]||(e[18]=t("option",{value:null},"Todas",-1)),(n(!0),l(y,null,_(V.value,o=>(n(),l("option",{key:o.id,value:o.id},s(o.nombre),9,ae))),128))],512),[[k,r.value.sucursal_id]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tipo",-1)),d(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>r.value.tipo=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},e[20]||(e[20]=[t("option",{value:null},"Todos",-1),t("option",{value:"faltante"},"Faltante",-1),t("option",{value:"excedente"},"Excedente",-1),t("option",{value:"horneado"},"Horneado",-1)]),512),[[k,r.value.tipo]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Estado",-1)),d(t("select",{"onUpdate:modelValue":e[5]||(e[5]=o=>r.value.atendida=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},e[22]||(e[22]=[t("option",{value:null},"Todos",-1),t("option",{value:"0"},"Sin atender",-1),t("option",{value:"1"},"Atendidas",-1)]),512),[[k,r.value.atendida]])])]),t("div",ne,[t("button",{onClick:q,disabled:D.value,class:"bg-orange-500 text-white px-6 py-2 rounded-md hover:bg-orange-600 transition-colors disabled:opacity-50"},[D.value?(n(),l("span",re,"Cargando...")):(n(),l("span",ie,"Filtrar"))],8,le)])]),t("div",de,[t("table",ue,[e[25]||(e[25]=t("thead",{class:"bg-gray-100"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Fecha/Hora"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Trabajador"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Sucursal"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Tipo"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"DescripciÃ³n"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Atendida")])],-1)),t("tbody",null,[(n(!0),l(y,null,_(P.value,o=>(n(),l("tr",{key:o.id,class:"hover:bg-gray-50 transition-colors"},[t("td",ce,[t("div",xe,s(o.fecha),1),t("div",pe,s(o.hora),1)]),t("td",ge,s(o.trabajador),1),t("td",be,s(o.sucursal),1),t("td",me,[t("span",{class:g([It(o.tipo),"px-2 py-1 text-xs font-medium rounded-full"])},s(o.tipo),3)]),t("td",ve,s(o.descripcion),1),t("td",fe,[o.atendida?(n(),l("span",ye," Atendida ")):(n(),l("button",{key:1,onClick:$=>Ht(o),class:"px-3 py-1 text-xs font-medium bg-orange-500 text-white rounded-full hover:bg-orange-600 transition-colors"}," Atender ",8,_e))])]))),128)),P.value.length===0?(n(),l("tr",he,e[24]||(e[24]=[t("td",{colspan:"6",class:"px-4 py-8 text-center text-gray-500"}," No se encontraron notificaciones para los filtros seleccionados ",-1)]))):v("",!0)])])])],512),[[O,m.value==="notificaciones"]]),d(t("div",null,[t("div",we,[t("div",ke,[t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha Inicio",-1)),d(t("input",{type:"date","onUpdate:modelValue":e[6]||(e[6]=o=>p.value.fecha_inicio=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},null,512),[[j,p.value.fecha_inicio]])]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha Fin",-1)),d(t("input",{type:"date","onUpdate:modelValue":e[7]||(e[7]=o=>p.value.fecha_fin=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},null,512),[[j,p.value.fecha_fin]])]),t("div",null,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Sucursal",-1)),d(t("select",{"onUpdate:modelValue":e[8]||(e[8]=o=>p.value.sucursal_id=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},[e[28]||(e[28]=t("option",{value:null},"Todas las sucursales",-1)),(n(!0),l(y,null,_(V.value,o=>(n(),l("option",{key:o.id,value:o.id},s(o.nombre),9,Ce))),128))],512),[[k,p.value.sucursal_id]])]),t("div",null,[e[31]||(e[31]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Usuario",-1)),d(t("select",{"onUpdate:modelValue":e[9]||(e[9]=o=>p.value.usuario_id=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},[e[30]||(e[30]=t("option",{value:null},"Todos los usuarios",-1)),(n(!0),l(y,null,_(z.value,o=>(n(),l("option",{key:o.id,value:o.id},s(o.nombre_completo),9,Se))),128))],512),[[k,p.value.usuario_id]])]),t("div",null,[e[33]||(e[33]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tipo",-1)),d(t("select",{"onUpdate:modelValue":e[10]||(e[10]=o=>p.value.tipo_actividad=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},e[32]||(e[32]=[Xt('<option>Todos los tipos</option><option value="produccion">Produccion</option><option value="venta">Ventas</option><option value="asistencia">Asistencia</option><option value="inventario">Inventario</option><option value="gasto">Gastos</option><option value="corte_caja">Corte de Caja</option>',7)]),512),[[k,p.value.tipo_actividad]])])]),t("div",je,[t("button",{onClick:Ut,disabled:N.value,class:"bg-orange-500 text-white px-6 py-2 rounded-md hover:bg-orange-600 transition-colors duration-200 disabled:opacity-50"},[N.value?(n(),l("span",Te,"Cargando...")):(n(),l("span",Ve,"Filtrar"))],8,Fe)])]),t("div",Ne,[t("div",Ee,[e[34]||(e[34]=t("div",{class:"text-sm text-blue-600 font-medium"},"Total Actividades",-1)),t("div",De,s(h.value.total_actividades),1)]),t("div",Me,[e[35]||(e[35]=t("div",{class:"text-sm text-yellow-600 font-medium"},"Ventas Manuales",-1)),t("div",Ae,s(((f=(C=h.value.ventas)==null?void 0:C.manuales)==null?void 0:f.cantidad)||0),1),t("div",$e,"$"+s(X(((Z=(W=h.value.ventas)==null?void 0:W.manuales)==null?void 0:Z.total)||0)),1)]),t("div",Ue,[e[36]||(e[36]=t("div",{class:"text-sm text-green-600 font-medium"},"Ventas Sistema (POS)",-1)),t("div",Pe,s(((et=(tt=h.value.ventas)==null?void 0:tt.sistema)==null?void 0:et.cantidad)||0),1),t("div",Be,"$"+s(X(((st=(ot=h.value.ventas)==null?void 0:ot.sistema)==null?void 0:st.total)||0)),1)]),t("div",He,[e[37]||(e[37]=t("div",{class:"text-sm text-purple-600 font-medium"},"Asistencias",-1)),t("div",Ie,s(((at=h.value.por_tipo)==null?void 0:at.asistencia)||0),1)])]),t("div",Oe,[t("table",Le,[e[39]||(e[39]=t("thead",{class:"bg-gray-100"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Fecha/Hora"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Usuario"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Sucursal"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Tipo"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Subtipo"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Detalles")])],-1)),t("tbody",null,[(n(!0),l(y,null,_(R.value,o=>{var $,Mt;return n(),l("tr",{key:o.id,class:"hover:bg-gray-50 transition-colors"},[t("td",ze,[t("div",Re,s(o.fecha),1),t("div",qe,s(o.hora),1)]),t("td",Ge,s(o.usuario),1),t("td",Qe,s(o.sucursal),1),t("td",Xe,[t("span",{class:g([qt(o.tipo),"px-2 py-1 text-xs font-medium rounded-full"])},s(o.tipo_label),3)]),t("td",Ye,[t("span",{class:g([Gt(o.tipo,o.subtipo),"px-2 py-1 text-xs font-medium rounded-full"])},s(o.subtipo_label),3)]),t("td",Je,[o.tipo==="venta"&&((Mt=($=o.extra)==null?void 0:$.productos)!=null&&Mt.length)?(n(),l("span",{key:0,title:o.extra.productos.map(U=>`${U.nombre} x${U.cantidad} = $${(U.cantidad*U.precio_unitario).toFixed(2)}`).join(`
`),class:"cursor-help underline decoration-dotted"},s(o.detalles),9,Ke)):(n(),l("span",We,s(o.detalles),1))])])}),128)),F.value.length===0?(n(),l("tr",Ze,e[38]||(e[38]=[t("td",{colspan:"6",class:"px-4 py-8 text-center text-gray-500"}," No se encontraron actividades para los filtros seleccionados ",-1)]))):v("",!0)])])]),E.value>1?(n(),l("div",to,[t("button",{onClick:e[11]||(e[11]=o=>b.value=Math.max(1,b.value-1)),disabled:b.value===1,class:"px-3 py-1 border rounded-md disabled:opacity-50 hover:bg-gray-100"}," Anterior ",8,eo),t("span",oo," Pagina "+s(b.value)+" de "+s(E.value),1),t("button",{onClick:e[12]||(e[12]=o=>b.value=Math.min(E.value,b.value+1)),disabled:b.value===E.value,class:"px-3 py-1 border rounded-md disabled:opacity-50 hover:bg-gray-100"}," Siguiente ",8,so)])):v("",!0),t("div",ao," Mostrando "+s(R.value.length)+" de "+s(F.value.length)+" actividades ",1)],512),[[O,m.value==="actividades"]]),d(t("div",null,[t("div",no,[t("div",lo,[t("div",null,[e[40]||(e[40]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha Inicio",-1)),d(t("input",{type:"date","onUpdate:modelValue":e[13]||(e[13]=o=>c.value.fecha_inicio=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},null,512),[[j,c.value.fecha_inicio]])]),t("div",null,[e[41]||(e[41]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha Fin",-1)),d(t("input",{type:"date","onUpdate:modelValue":e[14]||(e[14]=o=>c.value.fecha_fin=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},null,512),[[j,c.value.fecha_fin]])]),t("div",null,[e[43]||(e[43]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Sucursal",-1)),d(t("select",{"onUpdate:modelValue":e[15]||(e[15]=o=>c.value.sucursal_id=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"},[e[42]||(e[42]=t("option",{value:null},"Todas",-1)),(n(!0),l(y,null,_(V.value,o=>(n(),l("option",{key:o.id,value:o.id},s(o.nombre),9,ro))),128))],512),[[k,c.value.sucursal_id]])]),t("div",io,[t("button",{onClick:G,disabled:A.value,class:"flex-1 bg-orange-500 text-white px-4 py-2 rounded-md hover:bg-orange-600 transition-colors disabled:opacity-50"},[A.value?(n(),l("span",co,"Cargando...")):(n(),l("span",xo,"Filtrar"))],8,uo),t("button",{onClick:zt,class:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors"}," CSV ")])])]),t("div",po,[t("div",go,[t("div",bo,[t("div",null,[e[44]||(e[44]=t("p",{class:"text-sm opacity-90"},"Mejor Empleado",-1)),t("p",mo,s(((lt=(nt=w.value)==null?void 0:nt.mejor_general)==null?void 0:lt.nombre)||"-"),1),t("p",vo,s(((it=(rt=w.value)==null?void 0:rt.mejor_general)==null?void 0:it.total_puntos)||0)+" puntos",1)]),e[45]||(e[45]=t("div",{class:"text-3xl"},"ðŸ†",-1))])]),t("div",fo,[t("div",yo,[t("div",null,[e[46]||(e[46]=t("p",{class:"text-sm opacity-90"},"Mas Ventas",-1)),t("p",_o,s(((ut=(dt=w.value)==null?void 0:dt.mas_ventas)==null?void 0:ut.nombre)||"-"),1),t("p",ho,s(((xt=(ct=w.value)==null?void 0:ct.mas_ventas)==null?void 0:xt.total_ventas)||0)+" ventas",1)]),e[47]||(e[47]=t("div",{class:"text-3xl"},"ðŸ’°",-1))])]),t("div",wo,[t("div",ko,[t("div",null,[e[48]||(e[48]=t("p",{class:"text-sm opacity-90"},"Mas Horneados",-1)),t("p",Co,s(((gt=(pt=w.value)==null?void 0:pt.mas_horneados)==null?void 0:gt.nombre)||"-"),1),t("p",So,s(((mt=(bt=w.value)==null?void 0:bt.mas_horneados)==null?void 0:mt.total_horneados)||0)+" lotes",1)]),e[49]||(e[49]=t("div",{class:"text-3xl"},"ðŸ”¥",-1))])]),t("div",jo,[t("div",Fo,[t("div",null,[e[50]||(e[50]=t("p",{class:"text-sm opacity-90"},"Promedio Horas",-1)),t("p",To,s(((vt=B.value)==null?void 0:vt.promedio_horas_trabajadas)||0)+"h",1),t("p",Vo,s(((ft=B.value)==null?void 0:ft.total_empleados)||0)+" empleados",1)]),e[51]||(e[51]=t("div",{class:"text-3xl"},"ðŸ•‘",-1))])])]),t("div",No,[t("table",Eo,[e[53]||(e[53]=t("thead",{class:"bg-gray-100"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"#"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Empleado"),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b"},"Sucursal"),t("th",{class:"px-4 py-3 text-center text-sm font-semibold text-gray-700 border-b"},"Puntos"),t("th",{class:"px-4 py-3 text-center text-sm font-semibold text-gray-700 border-b"},"Ventas"),t("th",{class:"px-4 py-3 text-center text-sm font-semibold text-gray-700 border-b"},"Horneados"),t("th",{class:"px-4 py-3 text-center text-sm font-semibold text-gray-700 border-b"},"Notif."),t("th",{class:"px-4 py-3 text-center text-sm font-semibold text-gray-700 border-b"},"Horas"),t("th",{class:"px-4 py-3 text-center text-sm font-semibold text-gray-700 border-b"},"Acciones")])],-1)),t("tbody",null,[(n(!0),l(y,null,_(M.value,o=>(n(),l("tr",{key:o.user_id,class:g([{"bg-yellow-50":o.posicion===1,"bg-gray-50":o.posicion===2,"bg-orange-50":o.posicion===3},"hover:bg-gray-100 transition-colors"])},[t("td",Do,[t("span",{class:g({"text-yellow-600 font-bold text-lg":o.posicion===1,"text-gray-500 font-semibold":o.posicion===2,"text-orange-600 font-semibold":o.posicion===3,"text-gray-700":o.posicion>3}),innerHTML:o.posicion===1?"ðŸ†":o.posicion===2?"ðŸ¥ˆ":o.posicion===3?"ðŸ¥‰":o.posicion},null,10,Mo)]),t("td",Ao,[t("div",$o,s(o.nombre),1),t("div",Uo,s(o.email),1)]),t("td",Po,s(o.sucursal),1),t("td",Bo,[t("span",{class:g(["px-2 py-1 text-sm font-semibold rounded-full",o.total_puntos>=0?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},s(o.total_puntos),3)]),t("td",Ho,s(o.total_ventas),1),t("td",Io,s(o.total_horneados),1),t("td",Oo,s(o.notificaciones_atendidas),1),t("td",Lo,s(o.horas_trabajadas)+"h",1),t("td",zo,[t("button",{onClick:$=>Lt(o.user_id),class:"text-orange-600 hover:text-orange-800 text-sm font-medium"}," Ver detalle ",8,Ro)])],2))),128)),(yt=M.value)!=null&&yt.length?v("",!0):(n(),l("tr",qo,e[52]||(e[52]=[t("td",{colspan:"9",class:"px-4 py-8 text-center text-gray-500"}," No hay datos para mostrar en el rango de fechas seleccionado. ",-1)])))])])]),H.value?(n(),l("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:Yt(Q,["self"])},[t("div",Go,[t("div",Qo,[t("h3",Xo," Detalle de "+s((ht=(_t=x.value)==null?void 0:_t.empleado)==null?void 0:ht.nombre),1),t("button",{onClick:Q,class:"text-gray-400 hover:text-gray-600"},e[54]||(e[54]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),x.value?(n(),l("div",Yo,[t("div",Jo,[t("p",Ko,s((wt=x.value.empleado)==null?void 0:wt.email),1),t("p",Wo,"Sucursal: "+s((kt=x.value.empleado)==null?void 0:kt.sucursal),1)]),t("div",Zo,[t("div",ts,[t("p",es,s(((Ct=x.value.metricas)==null?void 0:Ct.total_puntos)||0),1),e[55]||(e[55]=t("p",{class:"text-xs text-gray-500"},"Puntos Totales",-1))]),t("div",os,[t("p",ss,s(((jt=(St=x.value.metricas)==null?void 0:St.resumen)==null?void 0:jt.ventas)||0),1),e[56]||(e[56]=t("p",{class:"text-xs text-gray-500"},"Ventas",-1))]),t("div",as,[t("p",ns,s(((Tt=(Ft=x.value.metricas)==null?void 0:Ft.resumen)==null?void 0:Tt.horneados)||0),1),e[57]||(e[57]=t("p",{class:"text-xs text-gray-500"},"Horneados",-1))]),t("div",ls,[t("p",rs,s(((Vt=x.value.metricas)==null?void 0:Vt.horas_trabajadas)||0)+"h",1),e[58]||(e[58]=t("p",{class:"text-xs text-gray-500"},"Horas",-1))])]),t("div",null,[e[59]||(e[59]=t("h4",{class:"font-semibold text-gray-900 mb-3"},"Historial de Puntos",-1)),t("div",is,[(n(!0),l(y,null,_((Nt=x.value.metricas)==null?void 0:Nt.historial,o=>(n(),l("div",{key:o.id,class:"flex justify-between items-center py-2 border-b border-gray-100"},[t("div",null,[t("p",ds,s(Rt(o.concepto)),1),t("p",us,s(o.descripcion||"-"),1),t("p",cs,s(new Date(o.created_at).toLocaleString()),1)]),t("span",{class:g(["px-2 py-1 text-sm font-semibold rounded-full",o.puntos>=0?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},s(o.puntos>=0?"+":"")+s(o.puntos),3)]))),128)),(Dt=(Et=x.value.metricas)==null?void 0:Et.historial)!=null&&Dt.length?v("",!0):(n(),l("p",xs," Sin historial de puntos "))])])])):v("",!0)])])):v("",!0)],512),[[O,m.value==="evaluacion"]])])}}},gs={class:"py-6"},bs={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 p-2 md:p-8"},ms={class:"bg-white overflow-hidden shadow-xl rounded-xl"},hs={__name:"index",setup($t){const{props:u}=At();return(z,V)=>Jt(u).user.roles[0]!=="trabajador"?(n(),Kt(Qt,{key:0,title:"Actividad Personal"},{default:Wt(()=>[t("div",gs,[t("div",bs,[t("div",ms,[Zt(ps)])])])]),_:1})):v("",!0)}};export{hs as default};
